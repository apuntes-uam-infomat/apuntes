\section{Introducción}

En este curso vamos a estudiar ecuaciones diferenciales ordinarias. Comencemos definiendo su significado:

\begin{definition}\name{Ecuación diferencial ordinaria}
Una ecuación diferencial ordinaria (\textbf{EDO}) es aquella que contiene una función de \textbf{una} variable y sus derivadas respecto de dicha variable.

Formalmente, dada una función desonocida $$\app{y}{\R}{\R}$$ que lleva $x$ en $y(x)$, la ecuación $$F(x, y, y^\prime, y^{\prime\prime},\hdots, y^{(n-1)}, y^{(n)}) = 0$$ donde $y^{(n)}$ representa la derivada n-ésima de la función $y$, es una ecuación diferencial ordinaria de \textbf{orden}\index{Ecuación diferencial ordinaria!orden} n.
\end{definition}

Por simplicidad de notación utilizaremos indistintamente $y \equiv y(x)$.
Normalmente supondremos que la ecuación será de la forma $$F(x, y, y^\prime,y^{\prime\prime},\hdots, y^{(n-1)}) =  y^{(n)}$$
y diremos que está en \textbf{forma explícita}\index{Ecuación diferencial ordinaria!en forma explícita}, mientras que la dada en la definición estará en \textbf{forma implícita}\index{Ecuación diferencial ordinaria!en forma implícita}.

Para entender mejor las ecuaciones diferenciales ordinarias y su utilidad, veamos los siguientes ejemplos:

\img{img/tractriz.png}{Problema de la tractriz}{tractriz}{0.55}
\begin{example}[(Problema de la Tractriz)]
Supongamos que estamos situados en el origen de coordenadas, desde el cual arrastramos, en el sentido positivo del eje de ordenadas, una barra rígida de acero de longitud $L$ cuyo otro extremo se encuentra inicialmente en el punto $Z:(0,L)$. El problema de la tractriz trata de encontrar una expresión para la curva que describe dicho extremo de la barra al arrastrarla.

Llamaremos $y(x)$ a la expresión para la curva que queremos encontrar y al punto en el que se encuentra el extremo $P^\prime:(x, y(x))$.

Llamaremos $P$ al punto en el que nos situamos en cada instante.

Como se puede observar en la \textbf{Figura \ref{fig:tractriz}}, la barra de acero tiene la dirección de la recta tangente a la curva descrita por el extremo citado y siempre se mantiene la distancia $L$ entre $P$ y $P^\prime$.

Con esto obtenemos lo siguiente:
\begin{itemize}
\item Vector director de la recta tangente: $(1, y^\prime(x))$
\item Recta tangente: $(x,y(x)) + \lambda(1, y^\prime(x))$
\item Como sabemos que la recta tangente pasa por $P$ cuando $\lambda = -x$ (porque $P$ está en el eje de ordenadas y ha de tener la primera coordenada igual a cero) tenemos que \\$P=(0, y-xy^\prime(x))$
\item Ahora usando que la distancia entre $P$ y $P^\prime$ es $L$ vemos que \\$L = \sqrt{(P^\prime-P)^2} = \sqrt{x^2+x^2y^\prime(x)^2}$
\item Despejando $y^\prime$ tenemos \\$y^\prime(x)=\pm\sqrt{\frac{L^2}{x^2}-1}$
\item Se escogerá la rama negativa porque la recta tangente del problema tiene pendiente negativa. Por tanto sólo nos falta obtener nuestra función, que es $$y(x) = -\int{(\sqrt{\frac{L^2}{x^2}-1})dx} + C$$
\item Para averiguar $C$ atendemos al problema y observamos que tenemos un dato adicional, y es que $y(L)=0$ pues la posición inicial del extremo de la barra es $(L,0)$.
\end{itemize}
\end{example}
\img{img/perro-liebre.png}{Curva de persecución}{persecucion}{0.55}
\begin{example}[(Curva de persecución I)]
Supongamos que una liebre que se encuentra inicialmente en el origen de coordenadas comienza a huir, con velocidad $V_L$ y en el sentido positivo del eje de ordenadas, de un perro que inicialmente tiene la posición $(0,D)$ y que comienza a perseguirle con velocidad $V_P$ (Ver \textbf{Figura \ref{fig:persecucion}}).

Llamaremos $Q$ a la posición de la liebre en cada instante y $Q^\prime:(x,y(x))$ a la posición del perro.

Observamos que el perro, al perseguir a la liebre, siempre lo hace mirándole, por tanto, en cada instante, la recta tangente a la curva que describe el perro al perseguir a la liebre pasa por $Q$ y por $Q^\prime$.

Como dato adicional tenemos que la distancia recorrida por la liebre es $V_Lt$ y la distancia recorrida por el perro es $V_Pt$, por tanto, en cada instante, la liebre está en la posición $(0, V_Lt)$.

Tenemos pues:

\begin{itemize}
\item Vector tangente: $(1, y^\prime(x))$
\item Recta tangente: $(x,y) + \lambda(1, y^\prime(x))$
\item Como sabemos que la recta tangente pasa por $Q$ cuando $\lambda = -x$ (porque $Q$ está en el eje de ordenadas y ha de tener la primera coordenada igual a cero) tenemos que \\$Q=(0, y-xy^\prime(x))$ y además que $Q=(0, V_Lt)$ por tanto $V_Lt = xy^\prime(x)$
\item La distancia recorrida por el perro es $V_Pt =\int_x^D{\sqrt{1+(y^\prime(s))^2ds}}$
\item Despejando $t$ de ambas ecuaciones e igualando términos tenemos que $\frac{V_P}{V_L}(y-xy^\prime(x))=\int_x^D{\sqrt{1+(y^\prime(s))^2ds}}$
\item Derivando ambos términos y utilizando el cambio $p=y^\prime$ llegamos a $\frac{V_p}{V_L}xp^\prime=\sqrt{1+p^2}$
\item Integrando: $\sqrt{1+p^2}+p = e^{C_1}x^\frac{V_L}{V_T}$
\item Despejando de esta ecuación obtenemos $p$ y por tanto $y^\prime$, habrá que calcular la constante de integración y volver a integrar y a calcular la nueva constante de integración para obtener $y$, por lo que necesitaremos dos datos adicionales para efectuar este cálculo:$$y(D)=0$$ $$y^\prime(D)=0$$
\end{itemize}
La expresión que se obtiene depende de las velocidades $V_L$ y $V_P$. Vamos a simplificar el problema suponiendo $D=1$. Tenemos tres casos distintos:
\begin{itemize}
\item \textbf{Caso 1:} $V_L=V_P$\\
En este caso se tiene $y^\prime(x) = \frac{1}{2}(x-\frac{1}{x})$ de donde obtenemos $y(x) = \frac{1}{2}(\frac{x^2}{2}-ln(x))+C_2$ y utilizando el dato $y(1) = 0$ podemos hallar $C_2=\frac{-1}{4}$.\\Tenemos como solución $y(x) = \frac{x^2}{4}-\frac{1}{2}ln(x)-\frac{1}{4}$.\\ Una vez obtenida la expresión, podemos hallar la distancia entre la liebre y el perro, que dependerá de la posición del perro: $d=\sqrt{x^2+x^2(y^\prime(x))^2}$.\\ Como el perro va describiendo una curva y la liebre una recta vemos que el perro se va acercando poco a poco a la liebre. Sin embargo, cuando $x\longrightarrow 0^+$ vemos que la curva que describe el perro ``se parece'' cada vez más a una recta y por tanto en el infinito la distancia de separación se mantendrá constante.\\
Tenemos pues que $$\lim_{x\to 0^+} d = \frac{1}{2}$$
\item \textbf{Caso 2:} $V_L \lt V_P$\\
Tenemos la expresión $$y=\frac{1}{2}(\frac{x^{\frac{V_L}{V_P}+1}}{\frac{V_L}{V_P}+1}-\frac{x^{1-\frac{V_L}{V_P}}}{1-\frac{V_L}{V_P}})+C_3$$
En esta ocasión tenemos que el perro alcanza a la liebre. Sabiendo que $y(1) = 0$ podemos calcular la constante $C_3$ y el valor de $y(0)$ es el punto de captura.
\item \textbf{Caso 3} $V_L \gt V_P$\\
En este caso el perro no llega a alcanzar nunca a la liebre, que es más rápida. Al igual que hemos calculado la distancia de separación en el caso 1 y el punto de captura en el caso 2, en este caso lo interesante será calcular la tasa de separación entre la liebre y el perro.
\end{itemize}
\end{example}

Veamos otro ejemplo:

\img{img/cuadrado_hormigas.png}{Curva de persecución II}{persecucion2}{0.50}
\begin{example}[(Curva de persecución II)]
Supongamos que disponemos de una mesa cuadrada en cuyas esquinas hay colocadas 4 hormigas, $A, B, C,$ y $D$. (Ver \textbf{Figura \ref{fig:persecucion2}}). En el instante inicial cada hormiga empieza a perseguir a la que está en la esquina contigua (en el sentido contrario de las agujas del reloj). En este problema buscamos la expresión para la curva que describe cada hormiga.

Como primera observación, vemos que cada hormiga describirá la misma curva y que esta tendrá forma de espiral. Atendiendo a la simetría del problema, bastará con que analicemos el comportamiento de dos hormigas (Ver \textbf{Figura \ref{fig:hormigas}}). Como prevemos que la curva va a tener forma de espiral, trabajaremos con coordenadas polares, por tanto, el punto en el que se encuentra la hormiga $A$ será $A=(r(\theta)\cos(\theta), r(\theta)\sin(\theta))$. Por simetría, el punto $B$ tendrá la misma expresión sustituyendo el ángulo por $\theta+\frac{\pi}{2}$. Por tanto tenemos que como $r(\theta)=r(\theta+\frac{\pi}{2})$, $B=(-r(\theta)\sin(\theta), r(\theta)\cos(\theta))$

Al ser una curva de persecución, sabemos que la recta tangente pasa por los puntos $A$ y $B$. La recta tangente es $r\equiv (r\cos(\theta), r\sin(\theta))+\lambda(r^\prime \cos(\theta)-r\sin(\theta),r^\prime \sin(\theta)+r\cos(\theta))$

Como sabemos que la recta pasa por los puntos citados, $\exists \lambda \st r\equiv (-r\sin(\theta), r\cos(\theta))$. Obteniendo $\lambda$ y despejando tenemos 

\begin{equation*}
  \left\lbrace
  \begin{array}{l}
     r = r^\prime \\
     r(0) = \frac{L}{\sqrt{2}}  \\
  \end{array}
  \right.
\end{equation*}

Donde $L$ es la longitud del lado del cuadrado.

Finalmente obtenemos $r(\theta) = \frac{L}{\sqrt{2}}e^{-\theta}$

\end{example}
\img{img/hormigas.png}{Curva de persecución II - Análisis}{hormigas}{0.55}

En estos ejemplos hemos tenido una EDO y un(os) dato(s) que nos permite(n) calcular la(s) constante(s) de integración. En los casos en los que hemos tenido más de un dato, siempre se han referido al mismo punto, es decir, nos han proporcionado el valor de la función en un punto y el de su derivada en el \textbf{mismo} punto.

\begin{definition}\name[Problema de]{valores iniciales de Cauchy}
Un problema de valores iniciales de Cauchy es aquel en el que se presenta una EDO y unos datos iniciales que se refieren al mismo punto.
\end{definition}

Existen casos en el que los datos proporcionados no se refieren al mismo punto, tenemos entonces un problema de valores de contorno: 

\begin{definition}\name[Problema de]{valores de contorno}
Un problema de valores de contorno es aquel en el que se presenta una EDO y unos datos iniciales que \textbf{no} se refieren al mismo punto.
\end{definition}

Existen dos casos especiales de problemas de valores de contorno:
\begin{itemize}
\item Problema de Dirichlet: Se proporciona el valor de una función en puntos diferentes.
\item Problema de Neumann: Se proporciona el valor de la derivada de una función en puntos diferentes.
\end{itemize}

Hasta ahora hemos conseguido resolver algunos problemas en los que se nos presentaba una EDO de orden 1 o de orden 2. Una cuestión a plantearse es cómo tratar una EDO de orden $n$.

\obs
Una EDO de orden $n$ puede escribirse como un sistema de $n$ EDO de orden $1$.

Dada una EDO de orden $n$ de la forma $$F(x,y^\prime,y^{\prime\prime},\hdots, y^{(n-1)}) = y^{(n)}$$ podemos construir el sistema

\begin{equation*}
  \left\lbrace
  \begin{array}{l}
     y^\prime=p \textit{\textbf{ (orden 1)}}\\
     F(x,p,p^\prime,\hdots, p^{(n-2)}) = p^{(n-1)} \textit{\textbf{ (orden n-1)}}\\
  \end{array}
  \right.
\end{equation*}
que tiene una EDO de orden $1$ y una EDO de orden $n-1$. Iterando $n-2$ veces de esta forma a partir de aquí obtenemos un sistema de $n$ EDO de orden $1$.


Realicemos un último ejemplo de resolución de un problema utilizando una EDO.

\img{img/antena-parabolica.png}{Análisis de antena parabólica}{antena-parabolica}{0.55}
\begin{example}[(Antena parabólica)]
Vamos a estudiar por qué las antenas parabólicas han de tener forma de parábola. El objetivo es buscar una curva en la cual todas los rayos paralelos al eje que reboten contra dicha curva vayan dirigidos a un mismo punto.

Sabemos que, en una recta, el ángulo de reflexión es igual al ángulo de incidencia. Sin embargo, no podemos decir lo mismo sobre una parábola. Para solucionar esto, observamos que lo que ocurre es que ``localmente, el rayo rebota contra la recta tangente a la parábola en dicho punto'' (Ver \textbf{Figura \ref{fig:antena-parabolica}}).

Sea $(x,y(x))$ la gráfica de la curva, entonces, la recta tangente es $(1, y^\prime(x))$

Sabemos que $\dotproduct{x}{y}=\abs{x}\cdot\abs{y}cos(\theta)$ siendo $\theta$ el ángulo que forman los vectores $x,y$. Por tanto $cos(\theta)=\frac{\dotproduct{x}{y}}{\abs{x}\abs{y}}$

De aquí obtenemos que
$$\alpha = \frac{\dotproduct{(1,0)}{(1,y^\prime)}}{\sqrt{1+(y^\prime)^2}}$$
$$\beta = \frac{\dotproduct{(1,y^\prime)}{(x,y)}}{\sqrt{1+(y^\prime)^2}\cdot\sqrt{x^2+y^2}}$$

Igualando $\alpha$ y $\beta$ obtenemos
\begin{equation*}
  \left\lbrace
  \begin{array}{l}
     x+yy^\prime \\
     y(-d) = 0  \\
  \end{array}
  \right.
\end{equation*}

Siendo $d$ la distancia del vértice de la parábola al foco.

Para resolver la ecuación seguimos los siguientes pasos:
\begin{itemize}
\item Observamos que $x+yy^\prime = \derivative{x}\frac{x^2+y^2}{2}$ y que por tanto tenemos la EDO $\derivative{x}\frac{x^2+y^2}{2}=\sqrt{x^2+y^2}$
\item Llamamos $T=x^2+y^2$
\item Tenemos entonces
\begin{equation*}
  \left\lbrace
  \begin{array}{l}
     \frac{T^\prime}{2} = \sqrt{T} \\
     T(-d) = d^2  \\
  \end{array}
  \right.
\end{equation*}
\item Despejando obtenemos $\frac{T^\prime}{2\sqrt{T}} = 1$
\item Llegamos a que $(\sqrt{T})^\prime = 1$
\item Integrando y utilizando el dato proporcionado por el problema llegamos a la solución, que es la ecuación de una parábola.
\end{itemize}
\end{example}

En algunos de estos ejemplos hemos obtenido una EDO de la forma: $f(y)y^\prime = g(x)$, es decir, una EDO en la que los términos ``$x$ están separados de los términos $y$ e $y^\prime$''. Diremos que se trata de una \textbf{EDO de variables separadas}\index{Ecuación diferencial ordinaria!de variables separadas}. 
