\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{exmath}[2013/04/21 Extended math commands]

% Paquetes requeridos
\RequirePackage{amsmath} % Matemáticas
\RequirePackage{amsfonts} % Más matemáticas
\RequirePackage{amssymb} % Más matemáticas
\RequirePackage{graphicx} % Gráficos e imágenes
\RequirePackage{amsthm} % Otro paquete de matemáticas
\RequirePackage{framed} % Marcos
\RequirePackage{mdframed} % Marcos
\RequirePackage{xargs} % Argumentos variables
\RequirePackage{ifthen} % Para poner if-then-else
\RequirePackage{tocloft} % Tablas de contenidos
\RequirePackage{bbm}
\RequirePackage[shadow]{todonotes} % Marcas To Do (a hacer)
\RequirePackage{etoolbox} % Comandos guays.
\RequirePackage{commath}

\let\mder\md

\setlength{\marginparwidth}{2.6cm}
\reversemarginpar

% Comandos de lógica
\newcommand{\dimplies}{\Leftrightarrow}
\renewcommand{\implies}{\Rightarrow}
\newcommand{\nimplies}{\nRightarrow}
\newcommand{\Or}{\vee}
\newcommand{\y}{\wedge}
\newcommand{\tq}{\;\diagup\;}
\newcommand{\tlq}{\text{ tal que }}
\newcommand{\wtf}{(?)}
% Cálculo
\newcommand{\deriv}[2]{\frac{d\, #1}{d\, #2}}
\newcommand{\dpa}[2]{\frac{\partial\,#1}{\partial\, #2}}
\DeclareMathOperator{\rot}{rot} % Rotacional
\DeclareMathOperator{\dv}{div}  % Divergencia
\newcommand{\grad}{\nabla}
\DeclareMathOperator{\img}{img} % Imagen
\renewcommand{\epsilon}{\varepsilon}
\newcommand{\bigzero}{\text{\Large 0}}
\newcommand{\tlps}{\tilde{\Psi}}

\newcommand{\invers}[1]{#1 ^ {-1}}
\newcommand{\f}{\invers{f}}
\newcommand{\F}{\invers{F}}
\newcommand{\Rnxm}{\real^M\times\real^N}
\newcommand{\acum}[1]{\#1 \subset(#1) }
\newcommand{\rnk}{\real^{N+K}}
\newcommand{\rk}{\real^{N+K}}
\newcommand{\ncl}[1]{N\left(#1 \right)}

%Análisis matemático
\newcommand{\normp}[2]{\norm{\gor{#1}}_{#2}}
\newcommand{\liminft}[1]{\lim_{{#1}\rightarrow \infty}}
\newcommand{\mylim}[3]{\lim_{\gor{#1} \rightarrow \gor{#2}} F({#3})}
\newcommand{\df}[2][\wedge\,]{%
  \,
  \def\nextitem{\def\nextitem{#1}}% Separator
  \renewcommand*{\do}[1]{\nextitem \dif ##1}% How to process each item
  \docsvlist{#2}% Process list
} % Diferenciales
%No se donde meter
%Para mejorar después
\newcommand{\app}{\paragraph{Aplicaci\'{o}n:}}
\newcommand{\obs}{\paragraph{Obsevaci\' {o}n:}}


%Usuales para la notación de puntos de R^N

\newcommand{\gx}{\overline{x}}
\newcommand{\gs}{\overline{s}}
\newcommand{\gy}{\overline{y}}
\newcommand{\gz}{\overline{z}}
\newcommand{\ga}{\overline{a}}
\newcommand{\gb}{\overline{b}}
\newcommand{\gv}{\overline{v}}
\newcommand{\gu}{\overline{u}}
\newcommand{\gw}{\overline{w}}
%pullback
\newcommand{\pb}[1]{T^{\ast}#1}
% Caracteres 
\newcommand{\qeq}{\overset{?}{=}} % Un igual con una interrogación encima.
\renewcommand{\r}[1]{\overset{\circ}{#1}} % Un circulito encima de una letra-

% Operadores
\newcommand{\comb}[2]{\left( \begin{matrix} #1 \\ #2 \end{matrix} \right)} % Número combinatorio
\renewcommand{\abs}[1]{\left\vert #1 \right\vert} % Valor aboluto
\newcommand{\inv}[1]{{#1}^{-1}} % Inversa
\newcommand{\conj}[1]{\overline{#1}} % Conjugado
\newcommand{\avg}[1]{\overline{#1}}
\newcommand{\card}[1]{\abs{#1}} % Cardinal
\newcommand{\no}[1]{\overline{#1}} % Negación
\newcommand{\gor}[1]{\overline{#1}}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\newcommand*{\eq}{=}
\DeclareMathOperator{\rango}{rango}

% Comandos para conjuntos y relaciones
\newcommand{\x}{\times} % una x superguay.
\newcommand{\appl}[3]{#1 : #2\longmapsto #3} % Aplicación
\newcommand{\uexists}{\exists\, !\;} % Existe y es único
\newcommand{\sint}{\int_b^a\;}
\newcommand{\stdf}{$\appl{f}{X}{Y}$} % Típica función f:X -> Y
\newcommand{\rel}{\mathcal{R}} % Símbolo de relación
\newcommand{\parts}[1]{\mathcal{P}\left(#1\right)} % Partes de un conjunto
\newcommand{\ind}{\mathbbm{1}}
\newcommand{\gen}[1]{\pesc{#1}}
\newcommand{\ord}[1]{\text{ord}\left(#1 \right)}

% Estadística
\newcommand{\esp}[2][]{
\ifthenelse{\equal{#1}{}}
		{\mathbb{E}}
		{\mathbb{E}_{#1}}\left(#2\right)}
\newcommand{\prob}[2][]{
\ifthenelse{\equal{#1}{}}
		{\mathbb{P}}
		{\mathbb{P}_{#1}}\left\lbrace #2 \right\rbrace}
\newcommand{\var}[2][]{
\ifthenelse{\equal{#1}{}}
		{\mathbb{V}}
		{\mathbb{V}_{#1}}\left(#2\right)}
\newcommand{\fd}{\mathbb{F}}
\newcommandx{\convs}[3][1=,2=n,3=\infty]{\xrightarrow[#2\to #3]{#1}}
\newcommandx{\convdist}[1][1=n]{\convs[d][#1]}
\newcommandx{\convprob}[1][1=n]{\convs[P][#1]}
\newcommandx{\convcs}[1][1=n]{\convs[c.s][#1]}
\newcommandx{\sample}[1][1=X]{{#1}_1,\dotsc , {#1}_n}
\DeclareMathOperator{\sesgo}{sesgo}
\DeclareMathOperator{\ECM}{ECM}
\DeclareMathOperator{\cov}{cov}
\DeclareMathOperator{\emv}{emv}

% Abreviaciones para conjuntos usuales
\newcommand{\nat}{\mathbb{N}}
\newcommand{\ent}{\mathbb{Z}}
\newcommand{\rac}{\mathbb{Q}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\cplex}{\mathbb{C}}

% Vectores
\newcommand{\pesc}[1]{\langle #1 \rangle} % Producto escalar
\renewcommand{\md}[1]{\left|\left| #1 \right|\right|} % Módulo

% Vectores usuales, para no tener que andar escribiendo
\newcommand{\vx}{\vec{x}}
\newcommand{\vy}{\vec{y}}
\newcommand{\vf}{\vec{F}}
\newcommand{\va}{\vec{a}}
\newcommand{\vu}{\vec{u}}
\newcommand{\vn}{\vec{n}}
\newcommand{\vv}{\vec{v}}

% Teoremas
\newcounter{thm}[section]
\newcounter{ejr}[subsection]
%\numberwithin{equation}{section}
\renewcommand{\thethm}{\thesection.\arabic{thm}}
\renewcommand{\theejr}{\arabic{ejr}}

\newtheorem{lemma}[thm]{Lema}
\newtheorem{itheorem}[thm]{Teorema}
\newtheorem{corol}[thm]{Corolario}
\newtheorem{prop}[thm]{Proposici\'{o}n}
\newtheorem{axiom}[thm]{Axioma}

\newenvironment{remark}{\vspace{10pt}\par \noindent \textbf{Observaci\'{o}n}: }{}
\newtheorem*{props}{Propiedades}

\newcommand{\IS}{}

\newenvironment{op}[1]{\indent \\ \noindent\textsc{#1}\\\[}{\]}

\newcounter{apr}[ejr]
\renewcommand{\theapr}{\alph{apr}}


\newenvironment{rightbar}{\begin{mdframed}[topline=false, leftline=false, bottomline=false,%
  linewidth=2pt, innerleftmargin=0pt, rightmargin=0pt,%
  innerrightmargin=10pt, skipabove=0pt, skipbelow=0pt]}{\end{mdframed}}

\newcommand{\iPartSpaceSkip}{}
\newcommand{\ppart}{\indent \stepcounter{apr}\textbf{\theapr )} }
\newcommand{\spart}{
	\iPartSpaceSkip 
	\renewcommand{\iPartSpaceSkip}{\vspace{10pt}}
	\indent \stepcounter{apr}\textsc{Apartado \theapr )} 
	}
\newcommand{\solution}{\end{framed}\setcounter{apr}{0} \begin{rightbar} \itshape }
\newenvironmentx{problem}[1][1=]
{
	\vspace{1 pt}
	\stepcounter{ejr}
	\renewcommand{\iPartSpaceSkip}{}
	\begin{framed}
	\textbf{Ejercicio \ifthenelse{\equal{#1}{}}{\theejr}{#1}}:
}{\end{rightbar}\vspace{10 pt}}

\newenvironment{example}{\begin{rightbar} \itshape \paragraph{Ejemplo:}}{\end{rightbar}}


\newcommand{\listtheoremname}{Teoremas}
\newlistof[section]{ithm}{ithmc}{\listtheoremname}

\newcommand{\ithm}[1]{%
\refstepcounter{ithm}
\addcontentsline{ithmc}{ithm}{\protect\numberline{\theithm}#1}\par}

\newenvironmentx{defn}[2][1=, 2=None]{
	\vspace{15 pt}
	\renewcommand{\IS}{!}
	\ifthenelse{\equal{#2}{None}}
		{\index{#1}}
		{\index{#2}}

	\renewcommand{\IS}{ }
	\noindent \refstepcounter{thm} \textit{Definici\'{o}n \thethm}
	\textbf{#1}.\itshape}
	{\vspace{2 pt}}

\newenvironmentx{theorem}[2][1=, 2=None]{
	\vspace{2pt}
	\renewcommand{\IS}{!}
	\ifthenelse{\equal{#2}{None}}
		{\index{#1}}
		{\index{#2}}
	\ifthenelse{\equal{#1}{}}
		{}
		{\ithm{#1}}
	\renewcommand{\IS}{ }
	\begin{framed}

	\begin{itheorem}[#1]}
	{\end{itheorem}\end{framed}}

\newcommand{\printtheorems}{\listofithm}

\renewenvironment{proof}{\begin{leftbar}\noindent \textit{Demostraci\'{o}n.} }{\qed\end{leftbar}}

% Complejos
\newcommand{\ctrig}[1]{\cos \left(#1\right) + i \sin \left(#1\right)}
\newcommand{\ceul}[2]{#1 e^{i #2}}

% Matrices
\newcommand{\trans}[1]{{#1}^{T}}

% Estadística y probabilidad
\DeclareMathOperator{\bin}{Bin}
\DeclareMathOperator{\geom}{Geom}

% Imágenes
\newcommand{\easyimgw}[4]{\begin{figure}[htbp]\begin{centering}\includegraphics[width=#4\textwidth]{#1}\caption{#2}\label{#3}\end{centering}\end{figure}}
\newcommand{\easyimg}[3]{\easyimgw{#1}{#2}{#3}{0.8}}
