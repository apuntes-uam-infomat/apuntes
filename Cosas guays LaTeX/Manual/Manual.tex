\documentclass[palatino]{apuntes}

\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{longtable}
\usepackage{fancysprefs}
\usepackage{minted}
\usepackage{showexpl}
\usepackage{etoolbox}
\usepackage{booktabs}
\usepackage{pgfplots}

\definecolor{lightgrey}{gray}{0.95}

\lstset{basicstyle=\footnotesize\ttfamily}

\lstset{language=[LaTeX]TeX,
	texcsstyle=*\bf\color{blue},
	numbers=none,
	breaklines=true,
	keywordstyle=\color{darkgreen},
	commentstyle=\color{red},
	frame=none,
	tabsize=2,
	backgroundcolor=\color{lightgrey}
}

\makeatletter
\newlength{\parindent@save}
\AtBeginDocument{\setlength{\parindent@save}{\parindent}}
\patchcmd{\SX@put@code@result}% <cmd>
  {\SX@resultInput}% <search>
  {\setlength{\parindent}{\parindent@save}\SX@resultInput}% <replace>
  {}{}% <success><failure>
\makeatother

% Para meter los comandos en el índice
\newcommand{\cindex}[1]{\index{\textbackslash #1}}
% Si son entornos
\newcommand{\eindex}[1]{\cindex{begin\{#1\}}}

\author{Guillermo Julián Moreno}
\date{\today}
\title{\LaTeX\ para infomates}

\setcounter{tocdepth}{3}

\begin{document}

\begin{abstract}
Este documento pretende ser un manual de uso de \LaTeX\ y de los paquetes personalizados que tenemos para escribir los \href{http://github.com/VicdeJuan/Apuntes}{apuntes de matemáticas e informática}.  La idea es que sirva para aprender \LaTeX\ básico (\fref{chap:Introduccion}), que introduzca aspectos de \LaTeX\ avanzado (\fref{chap:LaTeXAvanzado}) y que documente los paquetes y comandos personalizados que hemos ido desarrollando a lo largo del tiempo (\fref{chap:PaqueteExtendido}).
\end{abstract}

\pagestyle{plain}
\maketitle

\newpage

\tableofcontents


\chapter{Una introducción a \LaTeX}
\label{chap:Introduccion}

Vayamos primero con las preguntas básicas: ¿qué es \LaTeX? Es un sistema de generación de documentos\footnote{En inglés, \textit{document typesetting system}, que queda mejor.}. En otras palabras, nosotros escribimos cosas y \LaTeX\ nos genera un documento como este mismo manual.

La siguiente pregunta es: ¿por qué usar \LaTeX\ y no Word o LibreOffice? Esta pregunta ya no tiene una respuesta tan clara, aunque podemos comentar algunas ventajas. Por ejemplo, es mucho más fácil obtener documentos maquetados a la perfección: \LaTeX\ nos permite despreocuparnos del formato mientras escribirmos porque él se encarga de todo: gestión de los párrafos, tamaño de fuente\footnote{A modo de curiosidad sobre las fuentes, una de las razones por las que \LaTeX\ saca documentos tan ``profesionales'' es lo que se llama el \textit{font kerning} o espaciado entre letras. Por si alguien quiere saber más, \href{http://nitens.org/taraborelli/latex}{este artículo en inglés es bastante interesante}.} para cada posible situación, colocación de los imágenes, saltos de página, numeración\ldots Básicamente, todo lo que se pueda automatizar se automatiza, mientras que nosotros nos preocupamos de lo importante: escribir. Además, no hace falta saber cómo maquetar bien los documentos para que nos queden bien, y además la mejor forma de hacer algo es siempre la más fácil.

Por supuesto, esto viene con un coste, y es que \LaTeX\ no es fácil. Sólo hay que ver que estás leyendo un manual para aprender: ¿cuándo has leído un manual para usar Word?

La razón por la que no es fácil es que con \LaTeX\ no escribimos letras, pulsamos botones y ya. En \LaTeX\ lo que se hace es escribir comandos y compilar el documento para generar algo legible, así que podemos decir que se parece bastante a programar. Por ejemplo, cuando queremos poner algo en negrita, no nos vamos al botón correspondiente en el programa: lo que hacemos es escribir el comando correspondiente (\verb|\textbf{negrita}|) para que cuando el compilador pase por ahí, sepa que tiene que poner esas palabras en negrita.

Esto tiene una cosa mala, y es que escribir un documento \textit{.tex} puede llegar a ser un poco infernal, porque ves los comandos y no lo que producen. Otro problema es que, al escribir comandos, puedes equivocarte y que el documento no compile. No sería un problema demasiado importante si no fuese porque la mitad de las veces los errores que muestra un compilador son complementamente inútiles. Más tarde veremos cómo enfrentarnos a esos errores de compilación, pero primero empezaremos por lo más interesante: nuestro primer documento \LaTeX{}.

\section{Hola Mundo: Primer documento con \LaTeX}

Decíamos antes que \LaTeX\ necesita un compilador, así que antes de nada vamos a necesitar instalarlo. También instalaremos un editor especializado. Aunque no es necesario (los documentos \textit{.tex} son texto plano que se pueden editar hasta con el bloc de notas), sí que nos vendrá muy bien para empezar, ya que nos facilitan mucho la vida con una interfaz amable y botones que hacen las cosas por nosotros.

\subsection{Instalando un entorno \LaTeX}

Lo que necesitaremos bajarnos en nuestro ordenador será una \textit{distribución \LaTeX}, que es una colección de programas y archivos de configuración que nos permitirán generar nuestros documentos. Según el sistema que usemos, tendremos que bajarnos una cosa u otra:

\begin{itemize}
\item \textbf{Windows}. Antes de decir cómo descargarse \LaTeX, haré una recomendación, y es que Windows no es el sistema más apropiado para esto, sobre todo si queremos editar los apuntes de infomates. Es mejor irse a un sistema POSIX (Linux o Mac OS X) que tenga una consola decente y con \textit{bash} para poder ejecutar los \textit{scripts} que tenemos en el repositorio. Además, estudiando informática, se acaba usando Linux sí o sí, así que cuanto antes se empiece a usarlo mejor. Si a pesar de todo queremos seguir con Windows, lo que hay que bajarse es \href{http://miktex.org/download}{la distribución MikTeX} e instalarla (es un instalador normal y corriente).

\item \textbf{Mac OS X}. Hay varias formas de instalarse \LaTeX\ en OS X, aunque yo recomiendo usar Macports\footnote{Macports es un gestor de paquetes al estilo \textit{apt-get} para OS X. \href{https://www.macports.org/install.php}{Estas son las instrucciones para instalarlo}.} e instalar los paquetes necesarios con \texttt{sudo port install texlive-basic texlive-bin-extra texlive-fonts-extra texlive-lang-spanish texlive-latex texlive-latex-extra texlive-math-extra}.

\item \textbf{Linux basado en Debian (Ubuntu y similares)}. El paquete básico para usar \LaTeX\ es \textit{texlive}, así que con \texttt{sudo apt-get install texlive} debería bastar. Es recomendable bajarse además \textit{texlive-latex-base, texlive-latex-extra, texlive-latex-recommended} para paquetes adicionales que no están en la distribución base.

\item \textbf{Linux no basado en Debian}. Como de estos hay muchos y los que se lo instalan suelen ser un poco más apañados que la media, daré por supuesto que sabrán encontrar los paquetes que necesitan instalar sabiendo los que necesita Ubuntu.
\end{itemize}

\index{TeXStudio}
Una vez que tenemos \LaTeX\ instalado, nos bajaremos el editor. Personalmente, recomiendo \href{http://www.texstudio.org/}{TeXStudio}, que funciona bastante bien, es fácil de usar y además es bastante potente.

\subsection{Un primer documento}
\label{sec:EstructuraDocumento}

Una vez que tenemos todo instalado, podemos hacer nuestro primero documento. El archivo está \href{https://github.com/VicdeJuan/Apuntes/blob/master/Cosas%20guays%20LaTeX/Manual/DocumentoMuestra.tex}{disponible para que que se pueda descargar y bajar} sin tener que copiar y pegar de un PDF.

\inputminted[linenos,tabsize=2,fontsize=\footnotesize, breaklines]{latex}{DocumentoMuestra.tex}

\begin{figure}[hbtp]
\centering
\includegraphics[width=\textwidth]{TeXStudio.png}
\caption{Una captura de pantalla de TeXStudio con el documento de muestra, junto con algunas indicaciones sobre la interfaz.}
\label{fig:TeXStudio}
\end{figure}

Es recomendable toquetear el documento y ver qué pasa si quitamos comandos, o si cambiamos letras. La \fref{fig:TeXStudio} muestra cómo queda este documento si lo vemos en TeXStudio.

En este documento podéis ver varios comandos (los que empiezan por ``\verb|\|''), de los cuales muchos no merecen demasiada explicación. Otros los veremos más tarde, como los relacionados con ecuaciones matemáticas.

Lo que sí vamos a comentar son los comandos \verb|\documentclass|, \verb|\usepackage|  y los \verb|\begin{document}| y \verb|\end{document}|. El primero debería estar siempre en la primera línea de cualquier documento \LaTeX, y le dice al compilador qué tipo de documento estamos escribiendo. En este caso es \textit{article}, aunque podría ser cualquier otro como \textit{book} o \textit{report}. El tipo de documento definirá qué márgenes usamos, el tipo de letra, los tipos de secciones que se pueden usar o los paquetes que se incluyen por defecto.

\cindex{usepackage}
\cindex{documentclass}
Eso nos lleva al siguiente comando, \verb|\usepackage|. Como su nombre indica, carga un paquete en el documento y siempre van en el preámbulo (ahora veremos qué es eso). Un paquete de \LaTeX\ puede o bien proporcionarnos comandos (por ejemplo, \textit{amsmath} nos proporciona los comandos \verb|\int| o \verb|\dotsb|) o bien cambiar el comportamiento de \LaTeX, como \textit{babel}, que con la opción \textit{spanish} traducirá las cadenas que el compilador inserte en el documento (por ejemplo, cuando ponga la fecha automáticamente o cuando ponga ``Figura N'' en las etiquetas de imágenes) en español.

Por último, nos quedan los comandos \verb|\begin{document}| y \verb|\end{document}|. Son un ejemplo de lo que se llaman ``entornos'' en \LaTeX. Como uno podría imaginar, marcan el inicio y el final del documento en sí. Lo que esté dentro de estos dos comandos es lo que se ve en el documento final. Lo que está fuera (antes del \verb|\begin{document}|, porque después de \verb|\end{document}| no debería haber nada) es lo que se llama el preámbulo, que podríamos decir que es la sección de ``configuración'' del documento.

\section{Formato y maquetación}

Ahora que ya sabemos a grandes rasgos cómo funciona un documento \LaTeX, vamos a ir viendo explicaciones más en detalle de cada aspecto, empezando por lo básico: cómo dar formato y maquetar nuestro documento.

\subsection{Dando estructura: secciones, subsecciones, párrafos y más}

\index{Tabla!de contenidos}
\index{Sección}
Normalmente, los documentos se organizan en secciones, subsecciones y similares. \LaTeX{} nos lo pone muy fácil para hacerlo. Sólo necesitaremos poner el comando correspondiente y se encargará de ponerle el número que le corresponda y de añadirlo a la tabla de contenidos si la hemos activado. Para que la tabla de contenidos nos aparezca en el documento, sólo tenemos que escribir \verb|\tableofcontents| donde queramos que se muestre.

\cindex{chapter}
Las posibles variantes de sección son las siguientes. Como aparece en el comentario, el comando \verb|\chapter| sólo se puede usar en algunos tipos de documento, como \textit{report} o \textit{book} (no \textit{article}).

\begin{minted}{latex}
\chapter{Un capítulo} % Sólo en algunos tipos de documento
\section{Una sección}
\subsection{Una subsección}
\subsubsection{Una subsubsección}

\paragraph{Un párrafo}

\subparagraph{Un subpárrafo}
\end{minted}

\index{Párrafo}
Además, como indicábamos en el documento de muestra, \LaTeX\ es algo especialito con los espacios en blanco y los párrafos. Varios espacios en blanco es lo mismo que uno sólo, y los saltos de línea se ignoran salvo que haya una línea en blanco, que es lo que indica a \LaTeX\ que hay un nuevo párrafo.

Si se quiere forzar un salto de línea (no recomendado, \LaTeX\ sabe mejor que cualquiera de nosotros cómo y donde romper las líneas; y si quieres cambiar de párrafo deberías poner una línea en blanco) podemos usar \verb|\\|, \verb|\newline| o \verb|\pbreak|.

\begin{LTXexample}[pos=r]
Esta linea
y esta otra
son del mismo parrafo.

Ahora si cambiamos de parrafo, y tambien podemos ver que
los       espacios dan igual, con uno basta.

El cambio de linea forzado queda un poco mas raro y \\
no cambia bien de
parrafo. Es mejor no usarlo.
\end{LTXexample}

\subsection{Dando formato: negritas, cursivas y demás tipo de letra}

\index{Cursiva}
\index{Negrita}
Una revisión rápida por los posibles tipos de letra que podemos tener:

\begin{LTXexample}[pos=r]
\textbf{negrita}, \textit{cursiva}, \texttt{monoespacio}

\Huge{muy enorme}, \huge{enorme},
\LARGE{muy muy grande},
\Large{muy grande}, \large{grande},
\normalsize{normal}, \small{reducido},
\tiny{muy reducido}.
\end{LTXexample}

\eindex{verbatim}
\cindex{verb}
También podemos querer escribir código y no preocuparnos porque \LaTeX\ lo trate de interpretar. Para eso podemos usar los entornos \textit{verbatim}:

\begin{LTXexample}[pos=r]
En el texto, podemos usar
\verb|\micomando| (atentos
a las barras verticales para
delimitar el argumento)
para que \LaTeX{}
no trate de interpretar lo
que ponemos como un comando.

Si queremos algo mas extenso
podemos usar el entorno
\textit{verbatim}:

\begin{verbatim}
\textit{LaTeX no interpreta esto}
\end{verbatim}
\end{LTXexample}

\subsection{Entornos menos básicos: listas, tablas, imágenes y más}

Pasamos ahora a temas básicos, pero algo menos básicos que poner formatos sencillos. Ahora toca ver cómo meter listas, imágenes, tablas, notas al pie y referencias en nuestros documentos.

\subsubsection{Listas}

\index{Lista}
Las listas son sencillas, y lo mejor es verlo con ejemplos. Por supuesto, las listas se pueden anidar.

\begin{LTXexample}[pos=r]
\begin{itemize}
\item Uno
\item Dos
\end{itemize}

\begin{enumerate}
\item Numerado
\item Por defecto
\begin{enumerate}
\item Incluso con anidaciones
\item Podemos poner todos los niveles
\begin{enumerate}
\item Que queramos
\end{enumerate}
\item \LaTeX{} hace todo
\end{enumerate}
\item De forma automatica.
\end{enumerate}

\begin{description}
\item[Etiqueta] Elemento
\end{description}
\end{LTXexample}

\subsubsection{Imágenes}
\label{sec:Imagenes}

\index{Imagen}
\cindex{includegraphics}
\eindex{figure}
Para poner imágenes, sólo es necesario un comando, \verb|\includegraphics|. La cuestión es que eso nos inserta la imagen directamente, y no nos permite poner una etiqueta ni referenciarlo más tarde. Lo que haremos será encerrar ese comando en un entorno \textit{figure}:

\begin{LTXexample}[pos=r]
\begin{figure}[hbtp]
\centering
\includegraphics[width=0.4\textwidth]{Patata.jpg}
\caption{Etiqueta para la figura}
\label{fig:FiguraEjemplo}
\end{figure}
\end{LTXexample}

El entorno \textit{figure} es lo que se llama un entorno flotante. La ventaja es que nos da opciones adicionales y además le dice a \LaTeX\ que coloque la imagen donde sea más conveniente, evitando dejar muchos espacios en blanco o rompiendo el flujo del texto. Esta es una de las cosas que más cambian con respecto a Word, y de lo que más cuesta convencer: es mejor dejar que \LaTeX\ ponga la imagen donde quiera: normalmente será una posición mejor que la que podamos poner nosotros, y además nos evitaremos dolores de cabeza cuando cambiemos el texto y se nos descuadren todas las imágenes (como en Word).

Lo que sí podemos decirle a \LaTeX\ es donde preferimos que ponga la imagen (luego nos hará caso o no) con las opciones \texttt{[hbtp]}. Cada letra denota una preferencia, y van ordenadas según su prioridad: primero intenta poner la imagen donde la has escrito; si no puede, en la parte inferior de la página; si no, en la parte superior; y si ahí tampoco puede la dejará en una página dedicada a imágenes. Las letras se pueden quitar y cambiar de orden según querramos que aparezca la imagen.

El comando \verb|\includegraphics[width=X\textwidth]{ruta/a/la/imagen}| es el que inserta la imagen en sí. Normalmente solemos limitar el ancho de la imagen con la opción \verb|[width=X\textwidth]|, donde $X$ es el porcentaje (entre 0 y 1) del ancho del texto que queremos que ocupe. Por ejemplo, \verb|0.5\textwidth| hará que la imagen ocupe la mitad del texto de ancho.

\cindex{caption}
\cindex{label}
El comando \verb|\caption| nos permite ponerle una etiqueta o ``caption'' a la imagen, para explicar qué es. Es conveniente usarlo, porque siempre se mantiene pegado a la imagen y además nos permite ver qué índice tiene la figura. Por último, el comando \verb|\label| le asigna un identificador a la figura para que podamos referenciarla más tarde (veremos cómo hacer eso en la \fref{sec:Etiquetas}).

\subsubsection{Tablas}
\label{sec:Tablas}

\index{Tabla}
\eindex{tabular}
\LaTeX\ también nos permite incluir tablas en los documentos, aunque no es especialmente cómodo. Necesitaremos usar el entorno \textit{tabular}, al que le especificamos las columnas que queremos usar. Después, ponemos los contenidos de la tabla, separando cada celda con el carácter \verb|&| y cada fila con el salto de línea \verb|\\|. Veamos un ejemplo:

\begin{LTXexample}[pos=r]
\begin{tabular}{rl|r|c||}
0 & 1 & 2 & 3 \\ \hline
texto & texto & texto & texto
\end{tabular}
\end{LTXexample}

\cindex{hline}
El primer argumento de \textit{tabular} es el especificador de columnas. Normalmente son los caracteres \textit{r,l,c}, que indican alineación de la celda a la derecha, a la izquierda o al centro respectivamente; y separados (o no) por caracteres \texttt{|}, que le dicen a \LaTeX\ que ponga una barra vetical entre esas dos columnas. Para poner barras horizontales, ponemos el comando \texttt{hline} al final de la línea.

Al igual que con las imágenes, la mayor parte de las veces nos interesará poner la tabla en un entorno flotante, \textit{table}, para que \LaTeX\ la coloque donde mejor venga y podamos poner un \textit{caption} y la referencia con \textit{label}.

\begin{LTXexample}[pos=r]
\begin{table}[hbtp]
\centering
\begin{tabular}{rl|r|c||}
0 & 1 & 2 & 3 \\ \hline
texto & texto & texto & texto
\end{tabular}
\caption{Etiqueta para la tabla}
\label{tbl:TablaEjemplo}
\end{table}
\end{LTXexample}

\subsubsection{Notas al pie}

\cindex{footnote}\cindex{footnotemark}\cindex{footnotetext}
Para poner notas al pie, simplemente tenemos que poner el comando \verb|\footnote{texto de la nota}| en medio del texto. Con eso, \LaTeX\ se encargará de colocar la nota en la página que toque y de enlazarla convenientemente. Si tenemos una nota que es demasiado larga y no queremos ponerla en medio del texto, podemos poner simplemente \verb|\footnotemark| donde queremos que aparezca el numerito, y después usar \verb|\footnotetext{texto}| tranquilamente.

Ponemos un ejemplo de uso, aunque la salida no queda del todo bien por cosas de \LaTeX. Es una pequeña muestra de que a veces las notas al pie son un poco puñeteras y en ciertos entornos no salen. De tofas formas, no deberíamos encontrar ningún problema si las usamos normalmente en el texto.

\begin{LTXexample}[pos=r]
En medio del texto\footnote{
El texto es esto} podemos poner
una nota al pie. Tambien podemos
poner\footnotemark y llenarlo
mas tarde.

\footnotetext{Por ejemplo, aqui lo
ponemos porque es una nota muy
larga y no queremos ensuciar el
texto.}
\end{LTXexample}


\subsubsection{Etiquetas y referencias}
\label{sec:Etiquetas}

\cindex{label}\cindex{ref}
Una característica muy potente de \LaTeX\ son las referencias. Usa \verb|\label{nombreEtiqueta}| cuando quieras referenciar otras partes del documento con \verb|\ref{nombreEtiqueta}}|. Por ejemplo, si pones una etiqueta debajo de un comando de sección, \verb|\ref{nombreEtiqueta}| mostrará el número de esa sección. También puedes hacerlo en ecuaciones, figuras, tablas, listados de código y otros entornos definidos en el paquete \texttt{exmath}. Para figuras y tablas, concretamente, hay que poner el \verb|\label| justo después del \verb|\caption|, tal y como aparece en las secciones \ref{sec:Imagenes} y \ref{sec:Tablas}.

\begin{LTXexample}[pos=r]
Ponemos una ecuacion con su etiqueta:
\begin{equation}
1 + 1 = 2 \label{eq:SuperImportante}
\end{equation}

Ahora podemos referenciarla: la
ecuacion \ref{eq:SuperImportante}.

Tambien podemos hacerlo con \eqref{eq:SuperImportante}.
\end{LTXexample}

La principal ventaja de usar las referencias así es que no tenemos que preocuparnos más de ellas: da igual que cambie la posición de lo que estamos referenciando, que su numeración sea distinta o incluso que cambiemos el modo de numerar (por ejemplo, que en lugar de usar números usemos letras): \LaTeX\ se encarga de mantenerlo todo coherente.

Lo único que tendremos que acordarnos de hacer es de compilar bien hasta que las referencias se resuelvan: a veces, en la primera compilación \LaTeX\ no encuentra las referencias y hay que hacer más pasadas para que funcione (ver la \fref{sec:FuncionamientoLaTeX} para una explicación algo más extensa de esto).

\section{Matemáticas en \LaTeX}

Habiendo llegado hasta aquí, ya deberíamos de saber generar documentos básicos en \LaTeX. Ahora bien, nos falta una de las características más potentes de este sistema, y que siendo infomates debería interesarnos mucho: escribir matemáticas.

\LaTeX\ tiene lo que se llama un ``modo matemáticas'', donde dejará de interpretar texto e interpretará los símbolos que pongamos como lo que son: ecuaciones y fórmulas matemáticas. Los principales son dos, aunque hay bastantes más. Por un lado, los dólares (\$) nos permiten poner ecuaciones en línea, en el párrafo. Por otro, con \verb|\[.. \]| \LaTeX\ nos pondrá la ecuación en una línea separada. Veamos un ejemplo.

\begin{LTXexample}[pos=r]
Podemos poner ecuaciones $1 = 2$
en linea, o tambien separadas con
\[ 1 = 2 + 4 \]

No hace falta poner el salto de
linea, se hace solo. Si escribimos
asi \[ 1 = \int 3 \] el salto es
automatico. De hecho, LaTeX no
cambia de parrafo.
\end{LTXexample}

A modo de aviso, en muchos sitios todavía se sigue usando dos dólares (\$\$) en lugar de los corchetes. No deberían usarse (es sintaxis antigua), y además puede dar algunos errores y generar text que no queda del todo bien.

Para usar matemáticas en un documento \LaTeX, es recomendable incluir el paquete \textit{amsmath}, que añade bastantes comandos y mejora el funcionamiento de las ecuaciones.

\subsection{Subíndices y superíndices, fracciones y raíces}

Para poner subíndices y superíndices, usaremos los caracteres \verb|_| y \verb|^| respectivamente. Por ejemplo:

\begin{LTXexample}[pos=r]
\[ a_b + 3^2 \]
\[ a_bj + a_{bj} + 3^{2i} + 3^2i\]
\end{LTXexample}

Hay que tener cuidado cuando querramos poner subíndices o superíndices con más de dos caracteres: en ese caso, hay que rodearlos con llaves porque si no \LaTeX\ sólo pone el primer carácter.

\index{Fracción}
\index{Raíz}
Las fracciones se ponen con el comando \verb|\frac{numerador}{denominador}|, o \verb|\dfrac| si estamos en modo \textit{inline} (con \$...\$) y queremos que la fracción no aparezca en tamaño pequeño.

Para poner raíces usaremos el comando \verb|\sqrt|, que como argumento opcional acepta el orden de la raíz:

\begin{LTXexample}[pos=r]
Las fracciones en el texto $\frac{1}{2}$
aparecen reducidas, cosa que
podemos corregir con $\dfrac{3}{4}$.

\[ \frac{3 + 2}{5} = 1 = \sqrt{1} = \sqrt[3]{1}\]
\end{LTXexample}

\subsection{Matrices}

Las matrices en \LaTeX\ tienen una sintaxis parecida a las tablas (\fref{sec:Tablas}): separamos las celdas por \verb|&| y las filas por \verb|\\|. La diferencia está en que usamos el entorno \textit{matrix} (o sus variantes \textit{pmatrix} o \textit{vmatrix}):

\begin{LTXexample}[pos=r]
\[
\begin{matrix}
1 & 2 \\
3 & 4
\end{matrix} =
\begin{pmatrix}
1 & 2 \\ 3 & 4
\end{pmatrix} =
\begin{vmatrix}
1 & 2 \\ 3 & 4
\end{vmatrix}
\]
\end{LTXexample}

\subsection{Delimitadores}

\cindex{left}
\cindex{right}
En ocasiones querremos introducir delimitadores, como paréntesis o llaves, en las ecuaciones. Normalmente funcionan bien, salvo cuando queremos meter cosas más grandes dentro (por ejemplo, un símbolo de sumatorio) que se quedan limitadores demasiado pequeños. Para evitar eso usaremos los comandos \verb|\left| y \verb|\right| seguidos de un carácter que \LaTeX\ cambiará de tamaño para que se ajuste bien. Si por lo que sea queremos que uno de los lados no tenga ningún delimitador, podemos usar un punto. Veámoslo claro con un ejemplo:

\begin{LTXexample}[pos=r]
\[ (1 + 2) = 3\]
\[ (\frac{3}{4} + 4) = \left(\frac{3}{4} + 1 \right)\]

% Podemos tener delimitadores distintos
% o incluso quitar uno de ellos con '.'
\[ \left(\sum \right] = \left(\int \right. \]
\end{LTXexample}

Siempre hay que acordarse de cerrar bien los delimitadores: si nos dejamos un \verb|\left| sin su correspondiente \verb|\right| (o viceversa) \LaTeX\ nos dará un error de compilación un poco raro.

\subsection{Símbolos, operadores y texto}
\label{sec:SimbolosOperadoresTexto}

Es obvio que, salvo unos pocos casos, necesitaremos símbolos complejos para nuestras ecuaciones. Prácticamente todos están definidos como comandos, incluyendo las letras griegas. Algunos, como los comandos de límite, integral o sumatorio, colocan los superíndices y subíndices correctamente cuando los ponemos. Veamos ejemplos de esos símbolos (\href{https://en.wikibooks.org/wiki/LaTeX/Mathematics#List_of_Mathematical_Symbols}{aquí hay una lista más completa}):

\begin{LTXexample}[pos=r]
\begin{gather*}
\forall x \,\exists y \in J \implies z \pm \infty \iff z = 1\\
\lim_{n\to 0} \delta = \int_a^b 3 \\
\sum_{i=1}^\nu A \leq \prod_{j=1}^K \imath m \\
\emptyset \subset \bigcup A_i = \bigcap B_j \subseteq \partial \Phi
\end{gather*}
\end{LTXexample}

\LaTeX\ también tiene definidos comandos para los operadores habituales, como funciones trigonométricas o logaritmos, para que aparezcan correctamente. Si no usamos esos comandos, nos quedarán ecuaciones bastante feas.

\begin{LTXexample}[pos=r]
\[ cos a = log b + arccos 3 \]
\[ \cos a = \log b + \arccos 3 \]
\end{LTXexample}

Si por otra parte queremos poner texto en la ecuación, tendremos que usar el comando \verb|\text| para que quede bien

\begin{LTXexample}[pos=r]
\[ f \in L \implies f es inyectiva \]
\[ f \in L \implies f \text{ es inyectiva} \]
\end{LTXexample}

Por último, a veces querremos forzar un espaciado concreto. Para ello podemos usar los comandos correspondientes: usar alguno de los comandos de espaciado \verb|\ \, \; \quad \qquad|.


\begin{LTXexample}[pos=r]
\[ \forall \; f \in\, L \implies \quad f \text{ es inyectiva} \]
\end{LTXexample}

\subsection{Caracteres en otras fuentes}

Muchas veces en matemáticas se usan caracteres con otras fuentes, como las caligráficas, góticas o dobles. El paquete \textit{amsfonts} proporciona los comandos necesarios:

\begin{LTXexample}[pos=r]
\[ \mathbb{RCNZ}\; \mathrm{upright}\; \mathfrak{ABCG}\; \mathcal{CPE} \]
\end{LTXexample}


\subsection{Entornos matemáticos}

El paquete \textit{amsmath} viene con un buen número de entornos matemáticos para organizar ecuaciones. Hay muchos, y están \href{ftp://ftp.ams.org/pub/tex/doc/amsmath/amsldoc.pdf}{bien documentados}. Sin embargo, vamos a describir los más interesantes:

\begin{itemize}
\item \textit{equation} Es igual que poner \verb|\[...\]|, con la diferencia de que nos pone un número de ecuación para que podamos referenciarla más tarde.
\item \textit{multline} Nos permite romper las ecuaciones en varias líneas cuando son muy largas, usando el comando \verb|\\|, y deja la alineación correcta.
\item \textit{align} Nos permite alinear las ecuaciones, usando el carácter \verb|&| como separador.
\item \textit{gather} Agrupa varias ecuaciones, centrándolas todas.
\end{itemize}

Todos estos entornos cuentan con versiones ``*'' (por ejemplo, \textit{multline*}) que hacen lo mismo pero sin incluir números de ecuación.

\begin{LTXexample}[pos=r]
\begin{equation} \label{eq:Ecuacion}
3 + 4 = 123
\end{equation}

En la ecuacion \eqref{eq:Ecuacion}...

\begin{multline*}
1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + \\
+ 10 + 11 + 12 + 13 + \sum_{i=14}^{\infty} i
\end{multline*}

\begin{align}
f(x) + \lambda &= g(x) + a \\
f'(x) &= g'(x) + \frac{a}{x} = \\
&= 4g'(x)^2
\end{align}

\begin{gather*}
f(x) = g(x) + a \\
k(x) = g'(x) + \frac{\partial a}{\partial x}
\end{gather*}
\end{LTXexample}

\section{Preguntas frecuentes}

Enhorabuena: ya deberías saber \LaTeX\ básico. Ahora, como buen manual, incluimos una sección de preguntas frecuentes.

\paragraph{Mi documento no compila y \LaTeX\ no me dice por qué: ¿qué hago?} Suele ser obligatorio acordarse de los familiares de los desarrolladores de \LaTeX\ por no poner errores más descriptivos. Una vez hecho eso, lo más útil suele ser mirar en qué línea ha fallado y buscar sospechosos habituales: comandos de matemáticas que están fuera del modo matemáticas, una barra baja que no está metida en el modo matemático...

A veces ocurre que el compilador no muestra el error en la línea que es, sino mucho después cuando se le acumulan tantos fallos que no es capaz de seguir. En ese caso suele ser útil revisar el registro de errores para ver qué más hay: a veces hay cosas útiles.

\index{-shell-escape}
Otra opción es que los argumentos de la línea de comandos no sean los correctos. En concreto, uno que suele dar problemas es \texttt{-shell-escape}, que a grandes rasgos permite que el documento a compilar haga llamadas a otros comandos del sistema. Si esa opción no está en la línea de comandos del compilador, puede dar problemas y fallar con errores raros.

En cualquier caso, \LaTeX\ no suele ser muy descriptivo con los mensajes de error, así que lo más recomendable es compilar el documento frecuentemente para detectar los fallos antes y no tener que navegar por un montón de líneas que acabemos de cambiar.

\paragraph{Los operadores matemáticos están muy juntos} El espaciado de algunos símbolos matemáticos no acaba de cuadrar en algunos casos, como por ejemplo $\forall a \in E \exists y(a) \in B$. En este caso, es recomendable usar los operadores de espaciado \verb|\ \, \; \quad \qquad| (ver \fref{sec:SimbolosOperadoresTexto}). Normalmente \verb|\,| es lo que mejor queda, pero esto va a gusto del consumidor.

\cindex{displaystyle}
\paragraph{Los subíndices me salen pequeños cuando uso el modo \textit{inline}} Cuando se usan matemáticas en modo \textit{inline} algunos operadores cambián el lugar de los subíndices y superíndices para que no ocupen mucho, quedando algo así: $\sum_{i=1}^k$. Si afecta, lo más probable es que quede mejor pasando la ecuación a una línea separada usando \verb|\[...\]|. Sin embargo, se puede añadir \verb|\displaystyle| al principio de la ecuación para que ponga los subíndices más claros:

\begin{LTXexample}[pos=r]
En linea $\sum_{i=1}^k$ y algo mejor
con $\displaystyle\sum_{i=1}^k$, aunque
quizas sea mejor ponerlo separado con
\[ \sum_{i=1}^k\]
\end{LTXexample}

\chapter{\LaTeX\ avanzado}
\label{chap:LaTeXAvanzado}

Una vez que ya nos manejamos con las cosas básicas de \LaTeX, vamos a pasar a cosas más avanzadas, como las etiquetas, índices, marcos y Tikz. También veremos parte de desarrollo de paquetes y clases de \LaTeX: cómo crear comandos y entornos y modificarlos para que hagan lo que nosotros queremos. Para eso, antes veremos cómo funciona exactamente \LaTeX, que nos ayudará a la hora de entender por qué tenemos que hacer ciertas cosas, como compilar dos veces, o qué es lo que puede estar fallando cuando algo no funciona.

\section{¿Cómo funciona \LaTeX?}
\label{sec:FuncionamientoLaTeX}

El capítulo anterior pretendía ser un tutorial básico de \LaTeX, para que podamos ponernos a escribir rápidamente. Pero para avanzar, creo que es importante saber cómo funciona este sistema, más que nada para entender de dónde salen los errores y saber exactamente qué es lo que estamos haciendo. Además, como curiosidad informática tampoco viene nada mal.

Para ser precisos, más que de \LaTeX\ deberíamos hablar de \TeX, que es el ``núcleo'' escrito por Donald Knuth. Este núcleo es un compilador que, a grandes rasgos, tiene dos fases: la de expansión y la de compilación.

Cuando compilamos un documento para generar un PDF, lo que va haciendo \TeX\ es ir leyéndolo carácter a carácter, e ir traduciéndolo. Los caracteres normales se pasan sin modificar, y los comandos (los que empiezan por \textbackslash, como \verb|\textbf|) se expanden.

La expansión de un comando no es más que sustituirlo por su definición sustituyendo los argumentos. Por ejemplo, yo puedo definir el comando \verb|\vector|, que recibe un argumento (denotado por \verb|#1|) y que se expande como \verb|$\mathbf{#1}$|. Así, cuando \TeX\ encuentre \verb|\vector{a}| lo sustituirá por \verb|$\mathbf{a}$|. Este proceso se va realizando de forma recursiva: cuando el compilador expande un comando y se encuentra que la expansión ha metido más comandos, los expande a ellos también. Todo esto se hace en orden de izquierda a derecha.

Así, comando a comando, \TeX\ va expandiendo el documento hasta llegar a la forma más básica, que son los comandos primitivos de \TeX, que simplemente dicen cosas tan de bajo nivel ``añade este carácter a la línea'' o ``ahora usa esta fuente''. Con esos comandos, \TeX\ va decidiendo cómo va a ser la estructura del PDF que va a generar (los saltos de línea o de página, o la colocación de las imágenes, por ejemplo).

Finalmente, esa información se pasa a la ``segunda etapa'' de \TeX, que transforma esos comandos primitivos en un formato estándar para un documento que nosotros podamos visualizar: normalmente es PDF, pero también pueden ser otros como DVI.

La parte específica de \LaTeX\ consiste en comandos adicionales que facilitan la vida al usuario, pero a grandes rasgos el proceso de compilación es el mismo.

En la práctica, hay algunas cosas algo más complicadas, pero básicamente así funciona \LaTeX. Lo primero que leerá del documento será el \verb|\documentclass|, que le dirá qué archivo base cargar: ese archivo cargará los comandos de \LaTeX\ básicos y prepará el documento (tipo de fuente, márgenes, papel, etc). Después, las sentencias \verb|\usepackage| cargarán otros documentos con más macros y comandos, y en cuanto empiece el documento con \verb|\begin{document}| el compilador empezará a procesar todos esos caracteres y comandos escritos, expandiendo estos últimos hasta llegar a las instrucciones primitivas para mostrar tu PDF.

\paragraph{¿Esto es importante?} Algo sí, más que nada porque nos explica de dónde salen dos tipos problemas muy habituales. El primero son los relacionados con la expansión de comandos: \LaTeX\ no es como un lenguaje de programación donde primero se evalúan los argumentos y luego se le pasan a la función. Aquí es al revés: primero se desarrolla la función (el comando) y luego se procesan los argumentos. Y si en algún momento algo no cuadra (cosa probable) la compilación falla.

La otra cuestión es algo que no hemos dicho explícitamente, pero que se puede ver: \TeX\ es un sistema de una sola pasada. Lee el fichero y va procesando según le llega, pero en ningún momento mira hacia atrás ni hacia delante\footnote{Por ejemplo, redefinir un comando a mitad del documento sólo afecta a partir de ese punto, no antes.}. El principal inconveniente es que a veces tendremos que recompilar el documento para que pille todos los datos, como las refrencias. Las referencias las escribe \LaTeX\ en un documento aparte cuando se las encuentra, así que si ponemos una referencia antes de declarar la etiqueta, no va a saber resolverlo. En la segunda pasada ya se encontrará esa etiqueta declarada en el archivo aparte así que ya podrá rellenar el comando \verb|\ref| correctamente.

Para más información sobre cómo funciona \LaTeX, es recomendable echarle un ojo al libro \textit{\TeX\ for the Impatient} o \textit{The \TeX Book}.

\section{\LaTeX\ para usuarios avanzados}

A lo largo de esta sección vamos a ver algunos aspectos de \LaTeX\ que o bien nos dan más opciones para crear mejores documentos, nos facilitan la vida a la hora de escribir documentos o nos permiten personalizar ciertas partes del documento. Y todo esto usando comandos estándar y sin tener que desarrollar nada. Todavía.

La idea de la sección es ir de las partes más sencillas a las más difíciles, aunque esto siempre es subjetivo así que es recomendable echarle un ojo a todo por si acaso.

\subsection{¿Dónde están documentados los paquetes?}
\label{sec:Texdoc}

\index{texdoc}
Aunque en el mundo de la informática no suele ser lo habitual, la mayoría de los paquetes de \LaTeX\ que podamos usar están bien documentados, con documentación que es accesible desde tu ordenador. Lo más fácil es usar el comando \textit{texdoc}: si desde la terminal ejecutas \texttt{texdoc nombrepaquete} se abrirá un PDF con la documentación del paquete.

Si no, en Internet suelen estar las soluciones. Además de tener el repositorio central \href{https://www.ctan.org/?lang=en}{CTAN}, también está \href{http://tex.stackexchange.com}{TeX - Stack Exchange} para resolver dudas y, por supuesto, Google.

\subsection{Cambiando los márgenes del documento}

\index{geometry}
\index{Margen}
\LaTeX\ viene con unos márgenes determinados por defecto según la clase que usemos. Por suerte, se puede modificar fácilmente, simplemente con el paquete \textit{geometry}. La sintaxis es muy sencilla, poniendo en el preámbulo (antes del \verb|\begin{document}|) lo siguiente:

\begin{minted}{latex}
\usepackage[left=3cm, right=1cm, top=3cm, bottom=2cm]{geometry} % Márgenes
\end{minted}

Como es fácil adivinar, \textit{left, right, top, bottom} se refieren a los márgenes izquierdo, derecho, superior e inferior del documento. El paquete tiene varias opciones más, todas documentadas apropiadamente en su \textit{texdoc} (ver \fref{sec:Texdoc}), pero en general son bastante menos habituales y no hace falta que las revisemos aquí.

\subsection{Manejando documentos grandes con varios archivos}
\label{sec:ExternalFiles}

\cindex{input}
Una ventaja de \LaTeX\ es que es muy fácil manejar documentos grandes, con muchas líneas. Si vemos que mantenerlo todo en un mismo archivo se hace incómodo, podemos separarlo en varios archivos distintos e importarlos en el documento principal con el comando \verb|\input|.

\begin{minted}{latex}
\documentclass{article}

\begin{document}
Empezamos aquí con una introducción...

\input{Seccion1.tex}
\input{Seccion2.tex}

LaTeX meterá automáticamente el contenido de los archivos que le hemos dicho
 y compilará todo como un único documento.
\end{document}
\end{minted}

El comando \verb|\input| recibe como argumento el nombre del archivo a incluir. Si el archivo está en otro directorio (por ejemplo, en un subdirectorio en la misma carpeta) tendremos que poner la ruta relativa (p.e., \verb|\input{tex/Seccion1.tex}|).

\subsection{Cómo personalizar la tabla de contenidos y la numeración de secciones}
\label{sec:Contadores}

La tabla de contenidos de \LaTeX\ se genera automáticamente a partir de las secciones y subsecciones del documento. Aunque los valores por defecto suelen estar bien, a veces querremos cambiarlo. Por ejemplo, si queremos que aparezcan secciones, subsecciones y subsubsecciones en la tabla de contenidos, tendremos que poner lo siguiente en el preámbulo

\index{tocdepth}
\begin{minted}{latex}
\setcounter{tocdepth}{3}
\end{minted}

El $3$ es la profundidad máxima de la tabla (sin contar capítulos). Si quisiésemos sólo secciones, podríamos poner un $1$ en su lugar, por ejemplo.

\LaTeX\ también nos permite cambiar cómo aparecen los contadores de sección, subsección y demás. La sintaxis en general es la siguiente:

\begin{minted}{latex}
% En general:
\renewcommand{\the[contador]}{\the[otrocontador]. \forma{[contador]}}

% Ejemplo: Secciones con numeros romanos
\renewcommand{\thesection}{\Roman{section}}

% Otro mas: Subsecciones con el numero de seccion de antes
% y contador en numeros.
\renewcommand{\thesubsection}{\thesection .\arabic{subsection}}

% En realidad podemos poner lo que queramos en el segundo
% argumento:
\renewcommand{\thesubsubsection}{Esta es la subseccion \alph{subsection}}
\end{minted}

\cindex{arabic}\cindex{alph, Alph}\cindex{roman, Roman}
Podemos modificar los contadores que queramos: todos tienen el mismo nombre que el comando correspondiente (p.e., \verb|\section| tiene como contador \textit{section}). En cuanto a las formas de imprimir el número concreto, tenemos cinco posibilidades: \verb|\arabic|, que nos saca números (1,2,3, ...); \verb|\alph| o \verb|\Alph| que nos sacará letras (a,b,c) en minúsculas o mayúsuculas; y \verb|\roman| o \verb|\Roman| que nos sacarán números romanos (I, II, IV...) en minúsculas y mayúsculas respectivamente.

\subsection{Referencias todavía más automáticas: fancyref}
\label{sec:fancyref}

\index{fancyref}
\cindex{fref}
Hay un paquete adicional que mejora las características de las referencias de \LaTeX\, que se llama \textit{fancyref}\footnote{Para poder usar \textit{fancyref} en el documento, sólo hay que añadir \texttt{$\backslash$usepackage\{fancyref\}} en el preámbulo del documento. Ver la \fref{sec:EstructuraDocumento} para saber qué es exactamente el preámbulo.}. Este paquete introduce el comando \verb|\fref|, que saca la referencia con el nombre que le corresponde y con el enlace. Además, \textit{fancyref} tiene un formato ``vario'' que muestra la página en la que está lo que estemos referenciando.

\begin{LTXexample}[pos=r]
Antes usabamos \ref{eq:SuperImportante},
pero tambien podemos hablar de la
\fref{eq:SuperImportante}, de la
\fref{sec:EstructuraDocumento} o
de la \fref[vario]{sec:Tablas}.
\end{LTXexample}

\textit{fancyref} depende de que las etiquetas tengan un cierto nombre, de la forma \textit{prefijo:Identificador}, para poner el nombre correcto. Estos prefijos están en la \fref{tab:PrefjosFref}.

Adicionalmente, hemos creado el paquete \textit{fancysprefs} que traducen los prefijos de \textit{fancyref} al español y añade algunos comandos para incluir el nombre de lo que estamos referenciando automáticamente. Este paquete está descrito en la \fref{sec:fancysprefs}.

\begin{table}[hbtp]
\centering
\begin{tabular}{l|l}
\textbf{Elemento} & \textbf{Prefijo} \\ \toprule
Capítulo & chap \\
Sección & sec \\
Ecuación & eq \\
Figura & fig \\
Tabla & tab \\
Ejercicio & ej \\
Proposición & prop \\
Lema & lem \\
Teorema & thm \\
Definición & def
\end{tabular}
\caption{Prefijos establecidos para que \texttt{fref} funcione correctamente.}
\label{tab:PrefjosFref}
\end{table}

\subsection{Estilos de página: pies y cabeceras}

\index{fancyhdr}
\index{Cabeceras}
\index{Pie de página}
Podemos personalizar los estilos de página como queramos usando el paquete \textit{fancyhdr} y configurándolo en el preámbulo. Por ejemplo, este código pondría una cabecera y un pie de página con el número de página.

\begin{minted}{latex}
\pagestyle{fancy}
\fancyhf{}

\rhead{Título del documento}
\lhead{Sección \thesection}
\cfoot{Página \thepage}

\renewcommand{\headrulewidth}{2pt} % Anchura de la línea de la cabecera
\renewcommand{\footrulewidth}{1pt} % Anchura de la línea del pie
% En ambos casos, poniendo 0pt desactivamos la línea correspondiente.
\end{minted}

Aunque sólo hemos usado tres comandos, \textit{fancyhdr} provee varios comandos del tipo \verb#\[rcl][head|foot]{Contenido}# que nos permiten personalizar lo que ponemos en la parte derecha, izquierda o central de la cabecera o pie de página, respectivamente. Aquí viene bien recordar los contadores que vimos \fref{sec:Contadores}, porque podemos usar esos sin problemas para referencias la sección actual.

También nos permite, como se puede ver en el código, la anchura de las líneas que usamos para separar la cabecera y el pie de página.

Para personalizar las cosas un poco más, hay dos posibilidades interesantes: si ponemos el paquete \textit{lastpage} podremos usar \verb|\pageref{LastPage}| para imprimir el número de páginas del documento. Así, podríamos poner \verb|\cfoot{\thepage de \pageref{LastPage}}| para tener un pie de página como el de este manual.

\cindex{leftmark}\cindex{rightmark}
Si lo que queremos es poner el nombre de sección o de capítulo está algo más complicado. Los comandos \verb|\leftmark| y \verb|\rightmark| sacan el primer nivel (sección normalmente, o capítulos si los estamos usando) y el segundo respectivamente, pero cambiar el formato o usar cosas distintas no es trivial y hay que cambiar algunos comandos.

\subsection{Tikz}
\label{sec:Tikz}

\index{Tikz}
A estas alturas, ya debería quedar claro que \LaTeX\ permite hacer bastantes cosas. Pero por si acaso, vamos a hacer una introducción a Tikz, que es el sistema que tiene \LaTeX\ para poder hacer dibujos directamente en el documento con comandos.

Tikz es un sistema impresionantemente completo. \href{http://osl.ugr.es/CTAN/graphics/pgf/base/doc/pgfmanual.pdf}{El manual} tiene más de 1.000 páginas, para que nos hagamos una idea. También tienen una \href{http://cremeronline.com/LaTeX/minimaltikz.pdf}{introducción rápida, en inglés}, con las cosas básicas y algunos ejemplos muy interesantes. Igualmente por Internet hay muchos recursos, como \href{http://faculty.cord.edu/ahendric/tex/TikZcheatsheet.pdf}{\textit{cheat-sheets} de referencia rápida} o una extensa \href{http://www.texample.net/tikz/examples/}{colección de ejemplos}.

Precisamente por lo completo que es, aquí simplemente vamos a introducirlo con ejemplos, comentando que se puede hacer e invitando al lector interesado a leer más en Internet, en el manual o experimentando por sí mismo.

\eindex{tikzpicture}
Para usar Tikz, primero hay que activarlo en el preámbulo con \verb|\usepackage{tikz}|. Después, cuando queramos hacer un dibujo, tenemos que meter los comandos de Tikz en un entorno \textit{tikzpicture}. Nota importante: los comandos de Tikz acaban \textit{siempre} en punto y coma: si no se pone, el compilador se puede atragantar y no acabar.

Vamos ahora con el ejemplo de comandos y de cosas que se pueden hacer. No pretende ser ejemplos completos, sino dar unas pinceladas para poder empezar a manejarse con Tikz. Para facilitar las cosas, ponemos junto con cada código los resultados que salen.

\begin{LTXexample}[width=0.4\textwidth, pos=r]
\begin{tikzpicture}
% Sistema de coordenadas sencillo: (X,Y)
\draw (0,0) -- (1,0);
\draw[thick, red] (1,0) -- (1,1);

% '->' como opción indica poner flecha
\draw[blue, ->] (1,1) -- (0,1);

% Podemos curvar lineas fácilmente
\draw[orange] (0,0) to[bend right] (1,0);

% Hay varias formas de poner las rectas: con lineas, con puntos...
\draw[dotted] (3,0) -- (4,0);
\draw[dashed] (3,1) -- (4,1);
\end{tikzpicture}
\end{LTXexample}

\begin{LTXexample}[width=0.4\textwidth, pos=r]
\begin{tikzpicture}
% Dibujar formas rellenas

% Con las dos esquinas ponemos el rectángulo
\fill[green] (0,0) rectangle (2,2);

% El segundo argumento es el radio del círculo.
\fill[red] (1,1) circle (0.5cm);

% Las formas pueden ser aleatorias
\fill[orange] (3,-1) -- (4,2) -- (2.5,0.5) -- cycle;
\end{tikzpicture}
\end{LTXexample}

\begin{LTXexample}[width=0.4\textwidth, pos=r]
\begin{tikzpicture}
% Tambien podemos usar "clipping" para recortar. Eso si, hay que usarlo dentro de un entorno "scope" para evitar recortar todo el dibujo.
\begin{scope}
% Mostramos solo lo que este dentro de esta region que definimos con "clip".
\clip (0,0) rectangle (1,1);
\fill[yellow] (0,0) circle (1cm);

% Funciona con todo lo que pongamos, no solo fill
\draw[red, thick] (-1,-1) -- (1, 1);
\node at (0, 0.5) {Hola};
\end{scope}

% Vemos que pasa si ponemos lo mismo sin clipping.
\begin{scope}[yshift=-1.5cm] % Ventajas de scope: podemos mover una parte del dibujo con xshift/yshift. Tambien podriamos usar scale = 2 para doblarle el tamano, por ejemplo.
\fill[yellow] (0,0) circle (1cm);
\draw[red, thick] (-1,-1) -- (1, 1);
\node at (0, 0.5) {Hola};
\end{scope}
\end{tikzpicture}
\end{LTXexample}

\begin{LTXexample}[width=0.4\textwidth, pos=r]
\begin{tikzpicture}
% Podemos poner nodos con texto o sin texto. Las llaves del final son necesarias siempre, eso si.
\node at (0, 1) {Hola};
\node[draw, circle, inner sep = 2pt, fill = red] at (0,2) {};

% Tambien se pueden poner etiquetas
\node[draw, circle, inner sep = 2pt, fill = blue, label = below:{$\alpha$}] at (2,2) {};

% Los nodos pueden ir nombrados para referenciarlos luego
\node[draw, circle, inner sep = 2pt, fill = orange] (A) at (2,0) {};
\node[draw, circle, inner sep = 2pt, fill = green] (B) at (4,0) {};
\draw (A) -- (B);

% Podemos hacerlo igual con los nodos con texto
\node (C) at (4, 5) {Hey};
\draw[->] (C) -- (B);

% Podemos decidir de que parte del nodo (south, west, north, east) sale la flecha
\draw[orange, ->] (C.west) -- (A);

% Y tambien podemos poner nodos en lineas
\draw (0,2) -- node[midway, above, sloped] {Algo} (C);
\draw (2,2) -- node[near start, below, sloped] {Algo2} (C);
\end{tikzpicture}
\end{LTXexample}

\begin{LTXexample}[width=0.4\textwidth, pos=r]
\usetikzlibrary{calc} % Para hacer calculos de puntos

\begin{tikzpicture}
% Dibujamos tres vertices de un triangulo
\node[draw, circle, inner sep = 2pt, fill = red, label = below:{$A$}] (A) at (0,0) {};
\node[draw, circle, inner sep = 2pt, fill = orange, label = below:{$B$}] (B) at (2.5,0) {};
\node[draw, circle, inner sep = 2pt, fill = green, label = above:{$C$}] (C) at (2,3) {};

% Ahora podemos hacer calculos y dibujar nodos donde queramos.
% Por ejemplo, un nodo a medio camino entre A y B
\node[draw, inner sep = 2pt, fill = blue] at ($(A)!0.5!(B)$) {};

% O sacar la recta perpendicular a AC que pasa por B
\draw (A) -- (C);
\draw[thick, dashed] (B) -- ($(A)!(B)!(C)$);

% Podemos sumar coordenadas
\node[draw, circle, inner sep = 2pt, fill = yellow, label = left:{$B + C$}] at ($(B) + (C)$) {};
\end{tikzpicture}
\end{LTXexample}

\begin{LTXexample}[width=0.4\textwidth, pos=r]
\begin{tikzpicture}
% Con colores tambien podemos hacer cosas chulas. Podemos combinarlos para sacar cosas distintas:
\fill[red!50!yellow] (0,0) rectangle (1,1);

% O hacer degradados
\fill[left color = red, right color = yellow] (2,0) rectangle (3,1);

% Y transparencias
\node at (4.5, 0.5) {Hola};
\fill[left color = red, right color = yellow, opacity = 0.3] (4,0) rectangle (5,1);
\end{tikzpicture}
\end{LTXexample}

\index{pgfplots}
\begin{LTXexample}[width=0.4\textwidth, pos=r]
\begin{tikzpicture}
% Tambien podemos hacer funciones
\draw[scale=0.5,domain=-3:3,smooth,variable=\x,blue] plot ({\x},{\x*\x / 3});
\draw[scale=0.5,domain=-3:3,smooth,variable=\x,red] plot ({\x},{sin(\x r)});
% Nota: los senos y cosenos tikz los trata con grados. Hay que poner la r para que convierta a radiantes.
\end{tikzpicture}

\begin{tikzpicture}
% Tambien se puede usar el entorno axis, que es mas facil de usar si solo queremos hacer graficas.
% Para activarlo, hay que poner \usepackage{pgfplots} en el preambulo.
\begin{axis}[width=5cm, domain = -1:1,	xlabel = $x$, ylabel = {$f(x)$}]
\addplot[color=orange, thick]{exp(x)};
\addplot[color=green, thick]{x^2};
\end{axis}
\end{tikzpicture}
\end{LTXexample}

\index{tikz-3dplot}
\index{3D}
\begin{LTXexample}[width=0.4\textwidth, pos=r]
\begin{tikzpicture}
% Tikz tambien se maneja con coordenadas 3D
\draw[->] (0,0,0) -- (1,0,0);
\draw[->] (0,0,0) -- (0,1,0);
\draw[->] (0,0,0) -- (0,0,1);

% Aunque no del todo bien. Esto funciona
\fill[blue, opacity = 0.3] (0,0,0) -- (0,1,0) -- (0,1,1) -- (0,0,1) -- cycle;

% Pero esto no como queriamos
\fill[red] (0,0,0) rectangle (0,1,1);

% Para cosas en 3D mas avanzadas, ver
% tikz-3dplot
\end{tikzpicture}
\end{LTXexample}

\subsection{Un compilador más completo: latexmk}

\index{latexmk}
Al principio de este capítulo veíamos cómo funcionaba \LaTeX\ (\fref{sec:FuncionamientoLaTeX}), y que uno los problemas es que a veces hay que hacer varias pasadas para que funcione todo bien, lo cual puede ser un poco pesado. Por suerte, hay una solución llamada \textit{latexmk}, que es un compilador\footnote{En realidad es un script en Perl que llama a pdflatex y demás compiladores según convenga, pero para el caso es un compilador.} que se encarga de hacer todo esto de manera automática. Simplemente ejecutando \texttt{latexmk -pdf -silent documento.tex} compilará todo, haciendo tantas pasadas como haga falta.

La segunda ventaja de \textit{latexmk} es que nos permite compilar el documento de forma continua: cada vez que lo guardamos, \textit{latexmk} recoge los cambios y recompila para que nuestro lector de PDF pueda actualizar el documento\footnote{En Linux, Evince y Okular recargan el documento automáticamente. En OS X, Skim funciona muy bien.}. Para ello sólo tenemos que añadir el parámetro \textit{-pvc}: \texttt{latexmk -pdf -silent -pvc documento.tex}.

\textit{latexmk} tiene varias opciones más (ver su página de manual) y merece la pena probarlo y usarlo para quitarnos de problemas. Suele estar disponible como un paquete normal en las distribuciones Linux (\texttt{sudo apt-get install latexmk} funciona, por ejemplo) y también en MacPorts y Brew para OS X.

\subsection{Beamer: presentaciones con \LaTeX\ (o como dije adiós a Powerpoint)}

\section{Ampliando \LaTeX: Desarrollo de comandos, entornos, paquetes y clases}

\subsection{Comandos}

\subsection{Entornos}

\subsection{Paquetes y clases}

\subsection{Paquetes auxiliares para el desarrollo}

\chapter{Manual paquetes extendidos}
\label{chap:PaqueteExtendido}

\section{Introducción: ¿qué podemos hacer con los paquetes extendidos?}

\section{Estructura de los paquetes extendidos}

\section{Documetación de los paquetes}

\subsection{\textit{exmath.sty}: Comandos y entornos adicionales de matemáticas}

\subsubsection{Entornos para teoremas y similares}

Los teoremas del paquete heredan de los teoremas de \texttt{amsthm}, pero además añaden un índice automático de teoremas que se puede imprimir en el documento con \verb|\printtheorems|. También se cargan automáticamente en el glosario de términos. El uso normal es el siguiente

\begin{LTXexample}[pos=r]
\begin{theorem}[Teorema de las gallinas cluecas]
Teorema.
\end{theorem}
\end{LTXexample}

El título se carga automáticamente como una entrada para el índice. Si, por lo que sea, queremos separar los términos (por ejemplo, para que en este caso aparezca primero \textit{Teorema} y luego, debajo, \textit{de las gallinas cluecas}, ved la última página), no podemos usar la exclamación del comando \verb|\index{}| porque aparecería en el título. En su lugar, podemos usar el comando \verb|\IS|, que actúa como una separación para el índice pero que no aparece en el título.

\begin{LTXexample}[pos=r]
\begin{theorem}[Teorema\IS de las gallinas cluecas]
Teorema.
\end{theorem}
\end{LTXexample}

Si, por lo que sea, queremos especificar nosotros el índice, podemos añadir un segundo argumento.

\begin{LTXexample}[pos=r]
\begin{theorem}[Teorema de las gallinas cluecas][Mi entrada]
Teorema.
\end{theorem}
\end{LTXexample}

Hay definidos varios entornos similares a teoremas. Todos ellos se pueden titular poniendo entre corchetes el título.

\begin{LTXexample}[pos=r]
\begin{lemma}[Lema cuarenta y dos]
\end{lemma}

\begin{corol}[Coro]
\end{corol}

\begin{prop}[De las desigualdades]
\end{prop}

\begin{axiom}
\end{axiom}

\begin{proof}
Probado queda.

Al final agrega un cuadradito de QED.
\end{proof}

\begin{op}{Nombre de operación}
x = 3 + 1
\end{op}
\end{LTXexample}

El entorno \texttt{op} incluye el modo matemático directamente, y el nombre de operación es obligatorio.

\subsubsection{Definiciones y conceptos}

Por otra parte tenemos el entorno \texttt{defn} para definiciones, que funciona exactamente igual que \texttt{theorem}:

\begin{LTXexample}[pos=r]
\begin{defn}[Título de la definición][(opcional) entrada para el índice]
\end{defn}
\end{LTXexample}

\subsubsection{Ejercicios}
\label{sec:Ejercicios}

Hay dos entornos para incluir ejercicios o ejemplos en los archivos. El primero es \texttt{example}, que acepta un argumento opcional como nombre del ejemplo.

\begin{LTXexample}[pos=r]
\begin{example}[Titulo]
Un ejemplo sobre cosas matematicas.

\[ 3 = 3 \]

Fin del ejemplo.
\end{example}
\end{LTXexample}

\index{problem}
\index{problemS}
El otro sería \textit{problem}, que viene con bastantes cosillas. Acepta un argumento opcional, que es el número de ejercicio. Si no se pasa este argumento, la numeración es automática y se genera de la forma \textit{Sección.Ejercicio}, de tal forma que se pueda referenciar luego con etiquetas. El comando \verb|\solution| separa enunciado y solución, y los comandos \verb|\ppart| y \verb|spart| sirven para separar los diferentes apartados (la numeración es automática). Además, hay una variante \textit{problemS} que pone ejercicios sin la numeración por sección. Ejemplo:

\begin{LTXexample}[pos=r]
\begin{problem}[3] \label{ej:Ejemplo}
Sea $x$ una cosa, entonces calcula:

\ppart Calcula la divergencia de $x$.
\ppart Calcula 3.
\ppart Supongamos que $x$ es otra cosa distinta. Entonces dime que te parece

\[ x^2 + 1 \]

\solution

\spart La divergencia es 0.

\spart

\[ 3 = \int_0^1 \delta(x^2) \]

\spart Muy bien.

\end{problem}

\begin{problemS}
Siguiendo con el ejercicio \ref{ej:Ejemplo}, dime mas cosas

\solution

\spart Mas cosas del \fref{ej:Ejemplo}.
\end{problemS}
\end{LTXexample}

\subsubsection{Imágenes}

Hay dos comandos para poner fácilmente imágenes. El principal es \texttt{easyimgw}

\begin{LTXexample}[pos=r]
\easyimgw{Patata.jpg}{Leyenda}{lblEtiqueta}{0.3}
\end{LTXexample}

El último argumento es la anchura de la imagen expresada como proporción de la anchura del texto. $0.3$ significa que ocupa un $30\%$ de la anchura del texto, por ejemplo.

También está el comando \verb|\easyimg|, el uso es el mismo salvo que sólo necesita tres argumentos: la anchura se omite y se toma el valor por defecto del $80\%$ de anchura del texto.

\subsubsection{Comandos adicionales}

Dado que en cada asignatura hay varias cosas que se repiten, viene muy bien definir los comandos en \textit{exmath.sty} para poder usarlos, y además así poder reutilizarlos en otras asignaturas.

\index{commandsampler.py}
Como son muchos, en esta documentación aparecen en el apéndice \ref{chap:Comandos}, con ejemplos de uso y su salida. La tabla se genera de forma automática con el script \textit{commandsampler.py}, en el directorio \textit{Cosas Guays LaTeX}. La documentación de cómo funciona está en el propio paquete \textit{exmath.sty}, aunque en algún momento debería de poner aquí cómo funciona.

\subsection{\textit{fancysprefs.sty}: Referencias mejoradas}
\label{sec:fancysprefs}

\index{fancyref}
\index{fancysprefs}
\cindex{nref}
\cindex{nrefl}
\textit{fancysprefs} está basado en \textit{fancyref}, que ya hemos descrito en la \fref{sec:fancyref}. Este paquete provee dos comandos adicionales, \verb|\nref{nombreEtiqueta}| y \verb|\nlref{nombreEtiqueta}|, además de traducir las cadenas de \textit{fancyref} al castellano.

El comando \texttt{nref} hace algo parecido a \textit{fref}, pero incluye también el nombre de lo que estemos referenciando. Así, sólo nos hace falta poner \verb|\nref{sec:fancysprefs}| para que aparezca ``\nref{sec:fancysprefs}''. Obviamente, el nombre cambiará automáticamente aquí si lo cambiamos en el entorno correspondiente. La variante \texttt{nlref} hace exactamente lo mismo pero con el título en minúsculas (muestra: \nlref{sec:fancysprefs}), que viene bien cuando estamos referenciado definiciones y no queremos que la primera letra esté en mayúscula.

\subsection{\textit{MathUnicode.sty}: Letras griegas directamente desde el teclado}

\index{MathUnicode.sty}

\subsection{\textit{tikztools.sty}: Herramientas y comandos extra para Tikz}

\index{tikztools.sty}
Para facilitar los dibujos de Tikz, el paquete \textit{tikztools.sty} tiene varios comandos predefinidos. Incluye las librerías usuales, algunos estilos interesantes: \textit{nodepoint} para poner puntos sencillos, \textit{vnlin, hnlin} para poner marcas verticales u horizontales, varias clases para marcar con flechas líneas (\textit{directed, dense directed, etc}, todas con un nombre bastante claro) y varios comandos para dibujar familias de curvas que programé en su momento para EDO y ahora mismo no tengo huevos a entender. También está el comando \texttt{tikzangle} para marcar ángulos en LaTeX.

\subsection{\textit{fastbuild.sty}: Recortando los tiempos de compilación}

\index{fastbuild.sty}
Tikz es lento, y cuando hay un montón de dibujos recompilar un documento puede ser un infierno. Este paquete, \textit{fastbuild.sty}, permite activar una caché de dibujos Tikz, de tal forma que los dibujos se generan en un PDF y después se incluyen, de tal forma que no hay que regenerarlos en cada compilación. Para activar esta caché, hay que incluir el comando \verb|\precompileTikz| en el preámbulo del documento.

\index{-shell-escape}
Internamente, lo que hace LaTeX cuando ahora se encuentre un dibujo Tikz, es abrir un nuevo proceso que compile el dibujo y después incluirlo en el documento. Por seguridad, la configuración por defecto de LaTeX impide la creación de nuevos procesos, por lo que hay que pasar como argumento \texttt{-shell-escape} al comando de compilación. Toda la caché se guarda en el directorio \textit{tikzgen}, hay que procurar que esté creado porque si no LaTeX se quejará con un error bastante críptico.

\subsection{\textit{apuntes.cls}: La base para crear documentos de apuntes}

También hay un archivo llamado \texttt{apuntes.cls}, que provee la clase \textit{apuntes}. Básicamente, lo único que hace es cambiar la fuente, ajustar la geometría e incluir el paquete \texttt{exmath}. De esta forma, lo único que hay que hacer para usar todo el paquete y clase es cambiar la clase del documento. Es decir, que la primera línea sea

\begin{verbatim}
\documentclass{apuntes}
\end{verbatim}

Además, la clase genera la portada y la cabecera, sólo hay que configurar la fecha, título y autor con los siguientes comandos, que deben ir después de la definición de \texttt{documentclass}.

\begin{verbatim}
\author{Autor}
\date{Fecha}
\title{Título del documento}
\end{verbatim}

\subsection{\textit{ejercicios.cls}: documentos simples y entrega de ejercicios}

Por si hace falta hacer documentos que sean únicamente ejercicios (probablemente para entregarlos), la clase \textit{ejercicios} sirve para eso. Reduce un poco los márgenes, pone una portada más discreta y pequeña, cambia a un tipo de letra algo más compacto y quita los marcos enormes a los problemas. El resto de comandos se puede seguir usando normalmente.

En este caso también puede venir útil usar el entorno \texttt{problemS} en lugar de \texttt{problem} para que los ejercicios no tengan la numeración estilo \textit{sección.ejercicio} (ver la \fref{sec:Ejercicios} para una descripción más detallada).

\appendix

\chapter{Comandos}
\label{chap:Comandos}

\setcounter{LTchunksize}{10}
\renewcommand{\arraystretch}{1.3}% Spread rows out...
\input{cmds.tex}

\newpage
\printindex

\end{document}
