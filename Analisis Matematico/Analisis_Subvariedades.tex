\section{Subvariedades diferenciales}
  
  \paragraph{Introducción}
  
  En $\real^3$ tenemos puntos (dimensión 0), curvas (dimensión 1), superficies (dimensión 2) y abiertos (dimensión 3) sobre los que integrar en los que la imaginación resulta bastante útil. Pero... ¿qué pasa en $\real^N$? 
  
  Entonces en $\real^N$ tenemos objetos de dimensión $0,...,N$ sobre los que vamos a poder definir propiedades, integrales, etc.
  
  Repasamos la idea de que en $\real^3$ podíamos representar una superficie de varias maneras y como calcular su plano tangente.
  \begin{itemize}
   \item Gráfica: $z=f(x,y)$
   \item Parametrización: $\appl{\phi}{D\subset\real^2}{\real^3}$
     
     $\phi(u,v) = (x(u,v),y(u,v),z(u,v))$
     
     Para calcular el plano tangente:
     
     \begin{itemize}
      \item \[T_u = \left( \dpa{x}{u},\dpa{y}{u},\dpa{z}{u}\right)\]
      \item\[T_v = \left( \dpa{x}{v},\dpa{y}{v},\dpa{z}{v}\right)\]
      \item\[ \overrightarrow{n} = T_u\times T_v\]
     \end{itemize}

     Nos podemos encontrar el problema de que $\overrightarrow{n} = \overrightarrow{0}$. ¿Cómo preveer lo que puede salir?, el rango de la matriz de las 6 derivadas tiene que ser 2.
     
   \item Conjunto de nivel $F(x,y,z) = 0$ .
   
   Para calcular el plano tangente en este caso tenemos que $\overrightarrow{n} = \nabla F$. 
   
   Nos puede ocurrir que $F$ no sea derivable o que $\nabla F = \overrightarrow{0}$. Supongamos que sea diferenciable, ¿cómo preveer que puede salir? Otra vez la matriz de las derivadas tiene que tener rango máximo (en este caso 1)
  \end{itemize}
  
  Vamos a ver que pasa con las curvas en $\real^3$ y cómo calcular la recta tangente
  
  \begin{itemize}
   \item Parametrizada: \[\sigma(t) = (x(t),y(t),z(t))\]
   
   \item Intersección de 2 superficies transversales, es decir,
   
   \[C = \left\{\begin{array}{cc} F_1(x,y,z) &= 0\\ F_2(x,y,z) = 0 \end{array} \right.\]
   
   Posibles enemigos que nos podemos encontrar: superficies cuya intersección sea un plano. Si se da este caso, entonces tenemos que los vectores normales a las 2 superficies son paralelos. Para evitar esto, la matriz formada por los 2 vectores normales tenga rango máximo.
                                                                   
  \end{itemize}

  Los ingredientes para esta sección de la asignatura son:
  \begin{itemize}
    \item
    \item
   \item Matriz diferencial
   \item Rango
  \end{itemize}

  
  \begin{defn}[Subvariedad\IS diferenciable]
  Sea $M \subset \real^{M+N}$.
  
  Diremos que M es una subvariedad diferenciable en $\real^{N+M}$ de dimensión n \[\dimplies \forall \exists \text{un entorno abierto} U \subset \real^{N+K}, \ga \in U \tlq U\cap M = \{\gx\in U\tq F(\gx) = \gor{0}\} \]\[\text{\textbf{para alguna función} } F\in C^1(U)\]
  \[\appl{F}{U\subset \real^{N+K}}{\real^K} \tlq \text{ rango } DF \text{ máximo } (=k)\]
  
  \[U\cap M = \left\{\begin{array}{cc}
                     F_1(x_1,...,x_{n+k}) = 0\\
                     F_2(x_1,...,x_{n+k}) = 0\\
                     \vdots\\
                     F_k(x_1,...,x_{n+k}) = 0
                    \end{array}\right.\] 
  \end{defn}

  Vamos a ver en un ejemplo un problema que tiene la definición:
  
  \paragraph{Ejemplos:}



Veamos ejemplos de si algunos objetos son variedades diferenciables o no:
PASAR A PARAGRAPHS

\paragraph{1)}
  Superficie en $\real^3$.
  
  \[\appl{F}{U\subset\real^3}{\real}\]
  \[\{(x,y,z) \tq F(x,y,z) = 0\}\]
  En este caso tenemos $N=2, K=1$.
  La condición de rango nos dice que $\nabla F(\gx) \neq (0,0,0) \implies $ en cada punto existe un vector normal $\overrightarrow{n}$
  \obs $M = \{z = f(x,y)\}$.
  
  Basta tomar $F(x,y,z) = f(x,y)-z$.
  \[DF = \left(\dpa{f}{x},\dpa{f}{y},-1\right) \neq (0,0,0)\]
  Las gráficas de funciones de 2 variables en $\real^3$ son siempre subvariedades (la condición de rango es gratuita)
  
\paragraph{2)}  Curvas en $\real^3$
  
  \[\sigma(t) = (x(t),y(t),z(t))\equiv S_1 \cap S_2 = \]
  \[= \{F_1(x,y,z) = 0\}\cap \{F_2(x,y,z) = 0\}\]
  Si tomamos $U\cap \sigma = \{(x,y,z)\in\real^3 \tq F_1 = 0 \y F_2 = 0\}$

  Siendo \[\appl{F}{U\subset\real^3}{\real^2}, N+K=3,K=2\]\[F(x,y,z) = (F_1(x,y,z),F_2(x,y,z))\]
  
  Veamos la condición de rango en este caso:
  
  \[rango \begin{pmatrix} \dpa{F_1}{x}&\dpa{F_1}{y}&\dpa{F_1}{z}\\\dpa{F_2}{x}&\dpa{F_2}{y}&\dpa{F_2}{z}\end{pmatrix}\]
  Para que el rango sea máximo, los vectores tienen que ser no paralelos, es decir, $S_1, S_2$ sean transversales, no paralelas.
  
  \paragraph{3)} Una manera un tanto rebuscada de definir un punto.
 \begin{gather*}
 \appl{F}{\real^K}{\real^K}
 \gx \rightarrow \gx - \ga
 \end{gather*}  
 
 \[M = \{\gx \in \real^K \tq F(\gx) = \gor{0}\} = \{\ga\}\]
 
 Tenemos $DF = Id \implies $ rango máximo.
 
 $\{\ga\}$ es una subvariedad diferenciable (dimensión 0, codimensión K)
 
 \paragraph{4)} $\appl{F}{\Omega\subset\real^N}{0}$. En este caso tenemos codimensión $0$ y dimensión $N$.
 
\paragraph{5)}
   \[\appl{F}{\real^2}{\real}\]
  
  Con $F(x,y) = x^3 - y^6$.
  \[M = \{(x,y) \tq x^3-y^6 = 0\}\]
  \[DF = (3x^2-6y^5)\]
  \[DF(0,0) = (0,0) \dimplies \text{ Rango 0}\]
  ¿Quiere esto decir que $M$ no es una subvariedad diferenciable en el 0?
  
  NOOOO
  
  Lo que quiere decir que no hemos encontrado la función que cumpla las hipótesis.
  \[M = \{x^3=y^6\} = \{x = y^2\}  = \{x-y^2 = 0\}\]
  
  Tomando $G(x,y) = x-y^2$, en la que $DG(x,y) = (1,2y)$ tiene rango 1 en el origen.
  

  Llamaremos a $N$ dimensión de $M$ y $K$ Codimensión.
 
  \paragraph{6)}
  
  \[M = \{(x,y)\in \real^2 \tq x^2-y^2 = 0\}\]
  
  Si 
	\[\appl{F}{\real^2}{\real}\]
	\[F(x,y) = x^2-y^2\]
  
  $DF = (2x,-2y)$. La condición de rango falla en $(0,0)$.
  
  Valoramos si este objeto NO es una subvariedad o si tendremos que definir una función de una manera más inteligente.
  
  En este caso, vemos que $M = \{ y=x \cup y = -x \}$. No debería ser una subvariedad, para ello vamos a intentar demostrarlo por reducción al absurdo.
  
  \emph{Supongamos} M subvareidad entonces existe un $U, (0,0) \in U$ y $\appl{G}{U\subset\real^2}{\real}, U\cap M = \{G(x,y) = 0\}$
  
\[rango DG(x,y) = 1, \forall(x,y) \in U\]
\[rango\left(\dpa{G}{x},\dpa{G}{y}\right) = 1\].

\subparagraph{Caso 1} Supongamos $\dpa{G}{x}(0,0) \neq 0$

Podemos aplicar el teorema de la función implícita: podemos despejar $x = x(y)$. En este caso:

$U \cap M = \{x(y)^2-y^2 = 0\}$.

Si fijamos $y=\varepsilon, \implies x(\varepsilon) = \pm \varepsilon$ No es una función. 

Es imposible que $\dpa{G}{x}(0,0) \neq 0$

\subparagraph{Caso 2} Pasa lo mismo con la derivada respecto de y (Ejercicio para el lector)


\textbf{Conclusión: } Este es el ejemplo de que cualquier objeto que tenga autointersección no puede ser subvariedad.


\paragraph{7)} $M = \{(x,y) \in \real^2 \tq x^2-y^2 = 0, y\ge 0\}$

Vamos a suponer que existe una función $F \in C^1$ que representa ese objeto (que viene definido por 2 condiciones). $M = \{F(x,y) = 0\}$ para alguna $F$.

Condición de rango: $\left(\dpa{F}{x},\dpa{F}{y}\right) \neq (0,0)$.

Estamos en el mismo caso anterior. Tenemos 2 posibilidades.

 $\dpa{F}{x} \implies $ Contradicción con el teorema de la función implícita.
 
 $x^2 - (y(x))^2 = 0 \implies y = \abs{x} \notin C^1$
 
 Completarlo se deja como ejercicio para el lector.

\paragraph{8)}

$N = \{(x,y)\in \real^" \tq x^2-y^2 = 0, y>0\}$

La lógica nos dice que este caso si debería ser subvariedad diferencial (ya que la definición de la función es local, y siempre podremos encontrar un entorno que no incluya el 0, que es el punto problemático).

La comprobación se deja como ejercicio para el lector.

\subsection{Subvariedades y parametrizaciones}
\paragraph{Ejemplo} Superficie en $\real^3$ parametrizada: $S = \{\Phi(u,v) = (x(u,v),y(u,v),z(u,v))\}$.

A la hora de trabajar con superficies parametrizadas, nos interesaría poder definir una especie de función inversa que nos permita hacer cambios en el plano y llevarlos a la superficie o al reves, pero... ¡tienen dimensiones distintas! La esperanza que nos queda es que la superficie parametrizada tiene dimensión 2, igual que el plano.


\subsection{Homeomorfismo}
\begin{defn}[Homeomorfismo]
Sea $\appl{\Phi}{\Omega\subset\real^N}{\real^{N+K}}, \Omega$ abierto.

$\Phi$ es un \emph{homeomorfismo} sobre su imagen $\dimplies $ la restricción $\appl{\Phi}{\Omega}{\Phi(\Omega)}$ es continua y tiene una inversa continua,
es decir, \[\exists \appl{\Psi}{\Phi(\Omega)}{\Omega} \tlq 
\left\{ \begin{array}{cc} 
\Psi(\Phi(\gor{u})) = \gor{u}, &\forall \gor{u} \in \Omega\\ 
\Psi(\Phi(\gor{x})) = \gor(x), &\forall \gx \in \Phi(\Omega)
\end{array}\right.\]

\paragraph{Definición 1)}
Dado un $\displaystyle \x_0 \in \Phi(\Omega) \implies \forall \varepsilon >0, \exists \delta>0 \tlq$ si $\begin{array}{lc}
\norm{\gx-\gor{x_0})} < \delta \implies \norm{\Psi(\gx)-\Psi(\gor{x_0})}<\varepsilon\\
\gx \in \Phi(\Omega)
\end{array}$

\paragraph{Definición alternativa de continuidad}
Si $\{X_n\}\subset\Phi(\Omega), \gor{X_n} \rightarrow \gor{x_0}\in\Phi(\Omega) \implies \Psi(\gor{X_n}) \rightarrow \Psi(\gor{x_0})$

\end{defn}

\paragraph{Ejemplo 1}

\[\appl{\sigma}{[0,2\pi)}{\real^2}\]
\[t \rightarrow \sigma(t) = (cos(t),sen(t))\]

Inversa: $\Psi(x,y) = t$ ángulo de la representación en polares.

Vamos a estudiar el problema de la continuidad:

Tomamos $\{(X_n,Y_n)\}$ con $x^2+y^2 = 1 \tlq (x_n,y_n) \convs (1,0)$

Si $\Psi$ es continua, debe ser $\Psi(x_n,y_n) \convs (1,0) = 0$. En este caso no es continua porque:

Si tomamos \begin{align*}
P_n &= \left(cos\left(2\pi - \frac{1}{n}\right), sen\left(2\pi - \frac{1}{n}\right) \right)
P_n &\convs (1,0)
\Psi(P_n) &= 2\pi - \frac{1}{n} \convs 2\pi\neq\Psi(1,0)
\end{align*}

\paragraph{Ejemplo 2}

\[\appl{f}{(0,1)\subset\real}{\real^2}\]
\[t \rightarrow f(t) = (t,g(t)), \text{continua, con inversa continua}\]

Vamos a definir la  inversa:
\[P\in f(0,1) \implies P(x,g(x)) \text{Para algún } x\in(0,1)\]
$P = (x,g(x))$

\[\Psi(P) = t \in (0,1) \tlq f(t) = (x,g(x)) \implies t = x\]
Vamos a estudiar la continuidad:
\[\{P_n\} \subset f(0,1), P_n \rightarrow P \in f(0,1)\]
\[P_i = (x_i,g(x_i)), \text{ para algún } i \in (0,1)\]
\[P_n \convs P_0 \dimplies (x_n,g(x_n)) \rightarrow (x_0,g(x_0)) \implies x_n (= \Psi(P_n)) \rightarrow x_0 (=\Psi(P_0)) \]

\obs ¿La gráfica de una función es homeomorfismo sobre su imagen?
\paragraph{Ejemplo 3}
\[\appl{\sigma_3}{(0,4\pi)}{\real^2}\]
\[t \rightarrow \sigma(t) = (cos(t),sen(t))\]
No es inyectiva $\implies \nexists \Psi$.

\paragraph{Ejemplo 4}
\[\appl{\sigma_4)}{(0,2\pi)}{\real^2}\]
\[t \rightarrow \sigma(t) = (cos(t),sen(t))\]
La diferencia con el ejemplo 1, es que es cerrado.

Hay que percatarse de que la $tg$ no es inyectiva, entonces... la inversa es algo más complicada que $arctg$
\[\Psi(x,y) = arctg\left(\frac{y}{x}\right)\in \left(\frac{-\pi}{2},\frac{\pi}{2}\right) (x\neq 0)\]

Vamos a definirla a trozos:

Dejuan: Guille, hazte una circunferencia y marca los trozos
\[
\begin{cases}
arctg\left(\frac{y}{x}\right) & (x,y)\in 1\\
arctg\left(\frac{y}{x}\right) + \pi & (x,y) \in 2\\
arctg\left(\frac{y}{x}\right)+2\pi& (x,y) \in 3
\end{cases}
\]

Hay que estudiar la continuidad en $(0,-1)$ y en $(0,1)$.

\paragraph{(0,1)}

Tomamos $\{P_n\} \rightarrow (0,1), P_n \in S_1$

Queremos probar que $\Psi(P_n) \rightarrow \Psi(0,1) = \frac{\pi}{2}$.

Ejercicio para el lector: 
Sucesiones que se acercan por la derecha o por la izquierda y comprobar que vale lo que tiene que valer.		

\paragraph{Ejemplo 5: Lemniscata}

\begin{figure}[hbtp]
\begin{center}
\begin{tikzpicture}[scale=2,declare function={
	lemnx(\x)=2.5*cos(\x) / ( sin(\x)^2+ 1);
	lemny(\x)=3*sin(\x) * cos(\x) / ( sin(\x) ^2 + 1;
	}]

% Ejes
\draw[->] (-3,0) -- (3,0);
\draw[->] (0,-2) -- (0,2);

% La curva
\draw[gray,domain=-90:270,samples=200] plot ({lemnx(\x)}, {lemny(\x)});

% Sucesión 1
\foreach \x in {-86,-82,...,-66}
\node[circle, red, draw,inner sep=2pt] at ({lemnx(\x)}, {lemny(\x)}) {};

% Sucesión 2
\foreach \x in {72,76,...,108}
\node[rectangle, blue, draw,inner sep=2pt] at ({lemnx(\x)}, {lemny(\x)}) {};

% Sucesión 3
\foreach \x in {242,246,...,266}
\node[diamond, orange, draw,inner sep=2pt] at ({lemnx(\x)}, {lemny(\x)}) {};

% Puntos t = 0, t=π
\node[label=above right:$t\eq 0$, draw, fill=white,circle, inner sep=2pt] at (2.5,0) {};
\node[label=above left:$t\eq \pi$, draw, fill=white,circle, inner sep=2pt] at (-2.5,0){};

% Flechas para indicar hacia donde va la t.
\foreach \x in {-45,44,134,224}
\draw[-angle 90] ({lemnx(\x)},{lemny(\x)}) -- ({lemnx(\x + 1)},{lemny(\x +1)});

% Etiquetas de las sucesiones.
\node[label={[red]below:(1)}] at ({lemnx(-66)},{lemny(-66)}) {};
\node[label={[blue]above:(2)}] at ({lemnx(72)},{lemny(72)}) {};
\node[label={[orange]above:(3)}] at ({lemnx(242)},{lemny(242)}) {};
\end{tikzpicture}
\caption{Curva Lemniscata}
\end{center}
\end{figure}

La parametrización es \[\sigma_5 (x(t),y(t)) = \left(\frac{\cos(t)}{\sin^2(t)+1},\frac{\sin(t)\cos(t)}{\sin^2(t)+1}\right), t\in \left(\frac{-\pi}{2},\frac{3\pi}{2}\right)\]

Al origen podemos acercarnos de distintas formas:

\begin{itemize}
\item Cuando $t \to - \frac{\pi}{2}$, nos acercamos por la sucesión 1 (desde abajo a la derecha).
\item Cuando $t \sim \frac{\pi}{2}$, nos acercamos por la sucesión 2 (la mitad de la curva, de arriba-derecha a abajo-izquierda).
\item Cuando $t \to \frac{3\pi}{2}$, nos acercamos por la sucesión 3 (desde arriba a la izquierda)
\end{itemize}

Sea $\{P_n\}\subset \sigma_5(t) \rightarrow (0,0)$.

Podemos tomar la sucesión $\{P_n\} = \{P_1,P_2,P_3,...\}$ cada uno en una región (1,2,3 ciclicamente).

\[\Psi(P_n) \begin{cases}
\in 3 & \text{ si }n \text{ es múltiplo de }3\\
\in 2 & \text{ si } n\equiv 2\ mod \ 3\\
\in 1 & \text{ si } n \equiv 1\ mod \ 3
\end{cases}\]

Por tanto $\nexists \displaystyle \lim_{n\rightarrow \infty} \Psi(P_n)$

\begin{remark} A pesar de que hemos demostrado que $\sigma$ es continua e inyectiva, esto no garantiza que la inversa sea continua.\end{remark}

\subsection{Parametrización}

\paragraph{Objetivo} definir "parametrización".

\subparagraph{Ejemplo 1} Curva parametrizada en $\real^3$

$\Gamma = \{\sigma(t) = (x(t),y(t),z(t)), t \in (a,b)\}$

Queremos excluir:
\begin{itemize}
\item Picos (valor absoluto. FOTO) 

Basta con imponer: $\sigma \in C^1 \y (x',y',z') \neq (0,0,0)$

\item Auto-intersecciones o Lemniscata (que no se auto-intersecciona pero por poquito) 

Basta imponer $\sigma$ sea un homeomorfismo sobre su imagen.

\end{itemize}

\paragraph{Ejemplo 2} Superficies de parametrización en $\real^3$.

\[S = \{\Phi(u,v) = (x(u,v),y(u,v),z(u,v)), (u,v)\in D\}\]

Queremos evitar:

\begin{itemize}
\item Cono, tienda de campaña
$Rango \begin{pmatrix}
T_u \rightarrow\\
T_v \rightarrow
\end{pmatrix} = 2 \implies $ Podemos calcular plano tangente
\item Autointersección
Aquí sí tenemos rango máximo, asíque impondremos la condición de homeomorfismo sobre su imagen.
\end{itemize}

Ya tenemos todo lo necesario para definir parametrización:

\begin{defn}[Parametrización\IS local]
Diremos que $\appl{\Psi}{\omega \subset \real^N}{\real^{N+K}}, \Psi \in C^1(\omega)$, es una parametrización local $\dimplies \left\{ \begin{array}{c}
 rango D\Psi = n \text{ máximo}\\
 \Psi \text{ es un homeomorfismo sobre su imagen}
\end{array}\right.$
\end{defn}



\paragraph{Ejemplos}
\subsubsection{Repaso de coordenadas cilíndricas y esféricas.}
\input{CALII/repaso_coordenadas.tex}
\subparagraph{Esfera en $\real^3$}
 $\Phi_{1,2}(x,y) = (x,y,\pm \sqrt{1-x^2-y^2})$. Esta \emph{"carta de parametrización"} nos deja sin definir el ecuador. Para ello tenemos que definir más \emph{cartas de parametrización} REF INDEX
 
 Estas cartas son expresando x,y en función de las otras 2. En total hacen falta 3 parametrizaciones.
 
 \subparagraph{Existe} otra manera de parametrizar, la proyección estereográfica.  
 
 \[(u,v) \in \real^2 \rightarrow (u,v,0) \rightarrow r\equiv (0,0,R) + t(u,v,-R) = (tu,tv,R(1-t)\]
 Imponiendo $\underbrace{P}_{r(t_0)} \equiv r\cap S$ tenemos: \[(t_0u)^2+(t_0v)^2 + R^2(1-t)^2 = R^2 \rightarrow ... \rightarrow t_0 = \frac{2R^2}{u^2+v^2+R^2}\]
 
 Conclusión: \[P = (tu,tv,R(1-t) = \frac{2R^2}{u^2+v^2+R^2}u,\frac{2R^2}{u^2+v^2+R^2}v,\frac{u^2+v^2-R^2}{u^2+v^2+R^2} = \Phi(u,v)\].
 
 Vemos que $\Phi\in C^1, \Phi(\real^2) = S_R-\{(0,0,R)\}$ ¿Es una parametrización?
 
 Hay que comprobar \begin{itemize}
 \item rango $D\Phi$ máximo. 
 \item $\Phi$ es homeomorfismo sobre su imagen, es decir, ¿Existe una inversa continua? 
 \end{itemize}
 
 Hay un montón de cosas divertidas que hacer con la proyección estereográfica.